Question,SQL,Dataset use,Table Used,question_vectors
"Create a query to get the number of unique users, number of orders, and total sale price per status and month.   Please use the time frame from Jan 2019 until Aug 2022","SELECT 
  FORMAT_DATE(""%Y-%m"", created_at) AS Month_Year
  , status
  , COUNT(DISTINCT user_id) as total_unique_users
  , COUNT(DISTINCT order_id) as total_orders
  , SUM(sale_price) as total_sale_price
FROM `bigquery-public-data.thelook_ecommerce.order_items`
WHERE 
  DATE(created_at) BETWEEN '2019-01-01' AND '2022-08-31'
GROUP BY 1,2
ORDER BY 1,2",bigquery-public-data.thelook_ecommerce.order_items,order_items,"[ 3.84951718e-02 -3.48534063e-02 -6.55336678e-02  2.73709595e-02
 -1.77387133e-01  6.40151724e-02 -1.64179746e-02  2.48283837e-02
 -5.96332140e-02 -2.44483147e-02  8.47127736e-02 -1.01651596e-02
  5.63897751e-02 -3.25722955e-02 -4.65083234e-02  8.83129332e-03
  4.17475635e-03 -1.66445095e-02  2.02926677e-02 -6.68608993e-02
 -3.89976352e-02 -1.22647183e-02 -6.42616898e-02 -6.30426332e-02
  2.95633171e-02 -1.82091463e-02  4.21079099e-02  8.78933351e-03
  4.27343771e-02  3.47893648e-02 -3.22402157e-02 -1.12817353e-02
  3.50858755e-02  1.41323224e-01 -4.88464274e-02 -1.45851344e-01
 -9.67170205e-03 -7.15335310e-02  2.23271828e-02 -6.50938079e-02
 -3.71247157e-02 -3.44542190e-02  7.99515378e-03 -7.04781711e-03
  1.04792519e-02  3.60618941e-02 -3.85188460e-02  1.03302002e-01
  7.15680420e-02  1.31839901e-01 -6.56177849e-02  7.47100916e-04
  2.03512553e-02  1.53512359e-02  2.54170503e-02  4.13375124e-02
 -4.13566642e-02 -8.37920085e-02 -5.76006919e-02  3.24331410e-03
 -3.89683098e-02 -5.07780574e-02  1.74588826e-03  1.11129107e-02
  7.46852206e-03 -1.88976936e-02 -3.17229629e-02  2.72291694e-02
  4.47787195e-02 -1.14610344e-02  1.59270293e-03 -1.65723786e-02
 -7.48131191e-03  2.74763070e-03 -6.61458895e-02 -4.07156255e-03
 -1.66726392e-02  5.27457427e-03  7.92950951e-03  1.24846455e-02
 -7.34508932e-02 -1.52126113e-02 -1.31279424e-01  4.22685109e-02
  6.66340217e-02  3.44118364e-02  8.24134424e-02  4.69000451e-02
 -4.48854119e-02 -2.71920413e-02  3.38811725e-02  1.66538328e-01
 -6.11686660e-03 -3.94435190e-02 -1.04018971e-01 -4.38413434e-02
 -2.48605274e-02  3.33612710e-02  1.01770550e-01  1.80693064e-02
  3.47980447e-02  1.23542370e-02 -4.22517173e-02 -5.09107076e-02
 -1.02626443e-01 -1.21520534e-02 -9.61882994e-03  6.30973326e-03
 -1.00204527e-01  4.47168425e-02 -1.11762889e-01 -5.04596271e-02
 -6.43401500e-03 -5.86169995e-02  4.08331081e-02 -1.26432907e-02
 -1.52740413e-02  3.82721610e-03  5.25705367e-02 -1.29203851e-04
  5.78783453e-02  1.09250277e-01  1.34739103e-02  2.98856962e-02
 -1.35242511e-02  4.61976454e-02  1.70176513e-02  3.52331693e-33
 -1.07789403e-02 -3.07711922e-02  5.76247349e-02 -5.92931323e-02
  2.97396473e-04  2.19735242e-02  3.63390855e-02 -4.20706235e-02
 -2.54660317e-05  1.34357912e-02  1.02685029e-02  2.25449027e-03
  2.09354255e-02 -2.36928351e-02 -2.05623694e-02 -4.09980305e-02
  1.34021372e-01 -1.43994216e-03  3.76070407e-03  4.59651425e-02
  4.97314259e-02 -5.55572920e-02  2.84141973e-02  1.06048316e-01
  3.71144824e-02 -1.56905521e-02  4.45011556e-02  2.98128668e-02
  6.99823201e-02  1.62424650e-02  1.14134617e-01 -6.43786564e-02
 -7.65887052e-02  8.02318472e-03 -2.80736908e-02  2.25474313e-02
  2.39263214e-02 -2.06561796e-02  5.59510440e-02 -3.34269628e-02
 -8.84629115e-02  3.73240486e-02 -1.22521655e-04 -3.02790292e-02
 -7.81143680e-02  7.85841644e-02 -3.47981378e-02  2.30189338e-02
  7.91229755e-02  5.80348186e-02 -6.39425144e-02 -3.03774569e-02
  7.90318998e-04 -3.61002684e-02  2.22412916e-03 -7.12596253e-02
 -4.26254347e-02 -5.77925034e-02 -1.03864968e-02 -7.76814763e-03
 -9.66463760e-02 -1.48534840e-02  6.08329177e-02 -5.67673072e-02
 -1.05257176e-01 -5.46342432e-02  2.64390372e-02 -3.38229500e-02
 -6.92266822e-02  2.97344942e-02  4.29567248e-02  2.08464749e-02
  7.36461058e-02 -6.65458143e-02 -2.36890875e-02  4.94363867e-02
  7.11897612e-02  4.27603647e-02  3.95061597e-02  7.54104257e-02
 -4.52097543e-02 -3.09644435e-02  6.73851818e-02  1.67087968e-02
 -3.29733291e-03  8.66778865e-02  4.21823971e-02  4.15561125e-02
 -3.41179129e-03 -4.94159358e-05 -3.41056474e-02 -4.49758349e-03
  2.71882629e-03  7.01402277e-02  1.29714962e-02 -4.14192120e-33
 -2.51611136e-02  9.26417634e-02 -4.05246951e-02 -4.13455851e-02
  7.86564946e-02  9.24491091e-04 -9.97806340e-02  9.31760222e-02
 -5.63469948e-03 -1.66785996e-02 -1.55005716e-02  1.56702343e-02
  5.68979830e-02  2.15135850e-02 -1.79033820e-02  4.97835912e-02
  4.46421653e-02 -3.55006522e-03  8.21189303e-03  4.44948860e-02
 -4.83876765e-02  1.28630057e-01 -6.99031651e-02  2.53483672e-02
 -2.06616726e-02  5.59558831e-02  2.98362076e-02 -4.13134508e-02
 -6.53889850e-02 -4.80179079e-02  3.37182768e-02 -1.28867552e-01
 -1.44577892e-02 -3.17702591e-02  1.13722803e-02 -6.74222633e-02
  2.09910423e-02 -7.01400859e-04  3.05409636e-02  5.57434149e-02
  3.10636684e-02  2.80089444e-03  6.04771487e-02 -2.75432784e-02
  2.23640706e-02  5.59329102e-03  8.72783363e-02 -3.16199660e-02
 -1.19559253e-02 -1.52902966e-02 -3.04803438e-02  6.73213229e-02
 -7.59511674e-03 -3.60938944e-02 -9.19816829e-03  3.22713628e-02
  1.85247473e-02 -3.29629257e-02  2.71010567e-02 -2.11834684e-02
 -1.36861056e-02  6.64847493e-02  1.76126994e-02  1.90665405e-02
 -1.31382011e-02 -2.84425803e-02  2.45517753e-02 -5.02330549e-02
 -7.86052868e-02 -2.08293516e-02  8.72207247e-03 -1.47297522e-02
 -2.38568150e-02  2.97596622e-02 -8.81631151e-02  2.51851734e-02
 -5.77627271e-02 -4.64173146e-02 -2.28980370e-02  4.01999317e-02
 -2.26456411e-02  7.31496960e-02  2.83050518e-02  5.10230362e-02
 -8.28789547e-02 -3.19760516e-02 -3.48853804e-02 -1.81965213e-02
  4.98520583e-02  2.77444739e-02 -6.74012229e-02 -3.98559198e-02
 -1.15133062e-01 -7.97644779e-02  2.69845184e-02 -3.07455501e-08
  4.80515845e-02  1.30661400e-02 -6.63515739e-03  8.71704295e-02
  7.40297511e-02 -4.57579121e-02  6.99252188e-02  5.86261079e-02
 -2.75302548e-02  3.22170630e-02  4.00871336e-02 -7.51645565e-02
 -9.30812284e-02 -3.22566479e-02 -3.69127393e-02  7.26225078e-02
 -2.79040206e-02  2.32557915e-02  7.21639581e-03 -6.16043992e-02
  1.78754516e-02  3.81923541e-02  9.33348238e-02  3.34935449e-02
 -2.27627847e-02  3.87534760e-02 -2.01633647e-02 -1.22819124e-02
 -3.80142266e-03  2.33530141e-02 -3.92296873e-02 -2.96898987e-02
  3.95048633e-02 -7.60228410e-02  4.70407382e-02 -1.77881699e-02
 -1.19081073e-01 -2.31621228e-02 -7.88246542e-02 -6.42974675e-02
 -7.20360130e-03  3.47954780e-02  4.04366180e-02  8.32046494e-02
  4.41987850e-02  3.75349750e-03 -4.60896902e-02 -7.00941682e-02
  1.09684262e-02 -1.76395159e-02 -9.53105371e-03 -1.67324375e-02
  1.07886344e-01 -2.64172088e-02 -5.59228957e-02  4.97829430e-02
  1.66626219e-02  3.75859700e-02  4.00636382e-02 -1.75798200e-02
  2.11004727e-02 -5.40924035e-02 -6.09910861e-02  8.29405487e-02]"
"Create a query to get frequencies, average order value, and the total number of unique users where status is completely grouped by month","SELECT 
  FORMAT_DATE(""%Y-%m"", created_at) AS Month_Year
  , ROUND((COUNT(DISTINCT order_id)/COUNT(DISTINCT user_id)),2) AS frequencies
  , ROUND((SUM(sale_price)/COUNT(DISTINCT order_id)),2) AS AOV
  , COUNT(DISTINCT user_id) AS total_unique_users
FROM `bigquery-public-data.thelook_ecommerce.order_items`
WHERE 
  status = 'Complete'
  AND DATE(created_at) BETWEEN '2019-01-01' AND '2022-08-31'
GROUP BY 1
ORDER BY 1",- bigquery-public-data.thelook_ecommerce.order_items,order_items,"[ 8.80516469e-02 -4.17059958e-02 -6.58921301e-02  4.45395969e-02
 -1.18354626e-01  2.43457500e-02  4.18256707e-02  8.17864202e-03
 -5.36965989e-02  1.12447822e-02  9.78000611e-02 -1.97711624e-02
  3.28927860e-02 -3.54715884e-02 -1.91579538e-03  7.71557763e-02
  2.87039801e-02 -1.96179077e-02  2.94279438e-02 -5.14012128e-02
 -9.42130238e-02 -3.72978784e-02  6.87767426e-03 -5.65852672e-02
  2.77720559e-02  4.71478067e-02 -1.66230947e-02  2.09375378e-02
  7.84904882e-02  3.55702192e-02 -8.91625211e-02  1.05975404e-01
  9.50858146e-02  3.68891880e-02 -7.47789666e-02 -9.55674425e-02
 -3.71077098e-02 -1.04054533e-01  1.54512227e-02 -5.61641604e-02
 -6.67261928e-02  3.82576436e-02  1.24181226e-01 -5.50433248e-02
 -4.97223847e-02  3.48495245e-02 -3.35548893e-02  4.60825711e-02
 -1.80175304e-02  6.19006529e-02  3.59392576e-02  2.30985805e-02
 -1.89176686e-02  1.28652990e-01  5.74820638e-02 -3.40465009e-02
 -1.10374071e-01 -8.72321725e-02 -4.32998203e-02  6.20267875e-02
 -8.78274515e-02 -2.06263848e-02  3.77158704e-03  6.82095252e-03
  3.42330299e-02 -4.05929312e-02  2.45125243e-03  6.68169409e-02
  5.61491437e-02  5.67244692e-03 -3.22854668e-02 -4.09870632e-02
 -5.64988842e-03  6.98179454e-02 -2.55926070e-03  2.01007500e-02
 -1.12437814e-01  1.17277075e-02  6.82011023e-02  4.22682427e-02
 -9.32753533e-02 -3.48980688e-02 -8.35549831e-02  3.19705717e-02
  1.04640998e-01  1.30365100e-02  4.26525995e-02 -1.95025525e-03
 -9.30377394e-02 -1.20713608e-02 -1.99597795e-02  1.79017857e-01
  4.13152277e-02 -3.81806344e-02 -6.80105537e-02 -2.04154905e-02
  4.12561595e-02 -4.75824671e-03  5.95658384e-02  2.88382918e-02
  2.48953756e-02  4.77110110e-02 -4.95593660e-02 -5.34458831e-02
 -7.91063011e-02 -3.59545015e-02 -1.71567332e-02  8.26910883e-03
 -4.00019437e-02  4.86609861e-02 -1.09666534e-01  1.63600571e-03
  1.00688543e-02 -2.00948529e-02  2.10755728e-02 -1.67248957e-02
  4.97023650e-02 -1.72949843e-02  6.25280961e-02  1.55832181e-02
  2.43720822e-02  9.25111771e-02 -1.09394698e-03  8.44123438e-02
  5.67629188e-02  3.41836251e-02  8.31812918e-02 -4.09729576e-34
  3.03480942e-02 -3.85659337e-02  5.07779904e-02 -4.30365540e-02
  5.65081723e-02  2.53790524e-02  3.67671363e-02  4.85508936e-03
  4.15240228e-02 -1.54405590e-02 -1.32141355e-03  5.93600236e-02
  6.49752840e-02 -1.02335829e-02 -3.21102072e-03 -4.80677150e-02
  5.57628013e-02 -8.87035020e-03 -7.07953125e-02  2.30257194e-02
  8.91709253e-02 -1.29073802e-02  6.38001263e-02  4.50893417e-02
  1.26443096e-02 -6.36654859e-03  5.44978213e-03  1.50709916e-02
  6.29651695e-02  1.13714263e-02  3.88006456e-02  2.78084222e-02
 -3.95989791e-02 -6.51893392e-02 -9.28410608e-03  4.84360680e-02
  4.59333584e-02  3.63517851e-02  3.72589938e-02  4.52690274e-02
 -6.09899573e-02 -5.63305756e-03 -3.19325961e-02 -3.05582434e-02
 -4.08306532e-02  8.62220079e-02  8.60763656e-04  1.25712296e-02
  2.62376685e-02 -7.60391355e-03 -8.44703168e-02 -7.24375397e-02
  1.53269786e-02 -6.32362813e-02 -3.89703969e-03  3.32498178e-02
 -5.85857034e-02  4.82540578e-02 -4.98083755e-02 -6.18582172e-03
 -3.13729458e-02  2.78017926e-03  6.63013756e-02 -2.35038940e-02
  1.49075715e-02 -6.32981956e-02  8.35965548e-05  3.76515314e-02
 -6.06430508e-02  4.63455282e-02  1.11670800e-01  9.58725959e-02
  1.05777942e-02 -5.09483591e-02 -6.96618855e-02  5.70887625e-02
  7.23877922e-02  4.37421948e-02 -9.28880200e-02 -2.82853900e-04
  5.04641421e-02 -5.10570370e-02  3.05924788e-02 -4.41604108e-02
 -2.90250778e-03  5.15426770e-02  2.09455304e-02  2.06058770e-02
 -7.04997778e-02 -3.16997245e-03 -3.62248868e-02 -1.60153080e-02
  6.06736131e-02  1.58255957e-02 -2.46558953e-02 -1.80891113e-33
 -5.19764014e-02  7.68953785e-02  5.27772829e-02 -3.18112262e-02
  6.01319261e-02 -2.63389833e-02 -3.76218632e-02  4.16772626e-02
 -3.12390178e-02  4.27721888e-02 -1.83145721e-02  6.51703507e-04
  3.04295924e-02  1.71630997e-02 -2.67278384e-02  1.87752619e-02
 -2.40674149e-02  6.90148026e-03  1.99246258e-02  5.32660931e-02
 -6.16291277e-02  7.05937818e-02 -1.00887984e-01  7.48610497e-02
  8.17346573e-03  4.18072864e-02 -4.60228026e-02 -1.06509797e-01
 -4.76399772e-02  2.42946856e-03  3.35573666e-02 -1.17928371e-01
 -3.39717045e-02 -5.87525442e-02  6.58084545e-03 -6.57924786e-02
 -2.07657646e-02  3.00534982e-02 -2.31188984e-04  5.27361631e-02
  1.96007378e-02 -2.52939072e-02  2.61497009e-03 -5.10282721e-03
  1.35498336e-02 -4.09941003e-03  6.78906590e-02 -1.94999389e-02
 -8.59805420e-02 -4.53700833e-02  8.48594215e-03 -4.31875065e-02
 -4.36517298e-02 -1.39292991e-02  1.93065144e-02  1.86490454e-02
  3.59662883e-02 -5.04733287e-02 -1.51781151e-02 -6.64388984e-02
 -2.79652663e-02 -3.19821388e-02 -7.28324661e-03 -8.32872689e-02
 -3.45588103e-02 -3.52387615e-02  1.46234855e-02 -6.06442615e-02
 -1.07126854e-01  2.83457506e-02 -1.03933392e-02 -9.93011519e-03
  6.78174477e-03 -1.60347018e-02  3.83612025e-03  4.24426123e-02
 -3.74803655e-02 -4.11337502e-02 -8.80017206e-02  2.99654081e-02
 -9.90735367e-02  3.80592085e-02 -2.83679441e-02  9.28561296e-03
 -9.89815369e-02 -5.62353842e-02 -2.95693856e-02 -7.85265863e-02
  2.77447850e-02  3.18465941e-02  1.74414981e-02 -9.45431087e-03
 -1.07008129e-01 -3.93355973e-02 -2.06559268e-03 -2.47769574e-08
  4.82701138e-02 -2.40964945e-02 -5.73800765e-02  4.51063961e-02
  5.55384159e-02 -1.10789258e-02  3.17299031e-02 -1.59750488e-02
 -4.04933989e-02  3.76094948e-03  2.51489244e-02 -5.41579984e-02
 -5.65816462e-02 -2.72631459e-02 -9.67894029e-03  5.95114604e-02
 -7.02984110e-02  2.68916860e-02 -2.88578887e-02 -8.21405798e-02
 -1.19594038e-02  2.96468474e-02  9.31682289e-02  5.12257509e-04
 -3.02694254e-02  6.89140186e-02 -1.65417162e-03 -6.37879770e-04
  2.43557673e-02  5.73717710e-03 -5.44910394e-02 -1.39133651e-02
  2.59966720e-02 -5.10146171e-02 -2.88283620e-02 -2.54145097e-02
 -8.95648971e-02 -4.91732322e-02 -6.43040910e-02 -1.16618082e-01
  4.11010757e-02  7.89803788e-02  6.51518703e-02  9.15053412e-02
  4.76781949e-02 -2.38340069e-02  1.80160422e-02 -2.79014260e-02
  3.15545537e-02 -3.77336424e-03 -2.29525147e-03 -2.86615845e-02
  1.14296220e-01  1.67026073e-02  1.39120510e-02  9.56916139e-02
  2.85402387e-02  1.77385937e-02 -3.69729055e-03 -5.87003045e-02
  1.20420931e-02 -7.31656849e-02 -2.38220785e-02  7.76566342e-02]"
"Find the user ID, email, first and last name of users whose status is refunded on Aug 22","SELECT DISTINCT
 user.id as User_id
  , email
  , first_name
  , last_name
FROM `bigquery-public-data.thelook_ecommerce.users` user
JOIN `bigquery-public-data.thelook_ecommerce.order_items` orders 
ON user.id = orders.user_id
WHERE status='Returned'
  AND orders.created_at BETWEEN '2022-08-01'AND '2022-08-31'","bigquery-public-data.thelook_ecommerce.users
bigquery-public-data.thelook_ecommerce.order_items","users, order_items","[-4.88808639e-02  1.73937492e-02  4.84015346e-02  3.80849615e-02
 -6.14143442e-03  4.98893969e-02  7.49364644e-02  2.48549152e-02
 -6.34809509e-02  9.77240130e-03  6.89549372e-02 -4.51285467e-02
  6.62522332e-04 -1.20826632e-01 -1.69465214e-01  1.00871762e-02
 -5.87373599e-02  9.04043913e-02 -2.04311665e-02 -5.61117455e-02
 -2.08249614e-02  1.45706190e-02 -7.65831321e-02 -3.67970131e-02
  9.94295105e-02  5.85453734e-02 -2.01879032e-02 -1.51890367e-02
 -7.15767443e-02 -3.34113697e-03  5.47959395e-02  4.01715888e-03
 -8.55679903e-03 -3.70290056e-02 -9.59883444e-03 -4.88354266e-02
  1.39040472e-02 -1.49774691e-02  8.28060322e-03 -3.87206674e-02
 -9.00806487e-02 -2.43341550e-03  4.78784293e-02 -7.80198490e-03
  8.11808929e-02 -4.35173921e-02 -3.67304012e-02  4.88784201e-02
  2.87349913e-02  7.91949853e-02 -9.99930035e-03 -6.64125383e-02
  2.36030407e-02  8.36420879e-02  4.51669209e-02  6.51798695e-02
  9.69031360e-03  1.26845306e-02 -6.04380555e-02 -6.04901277e-03
  8.17740802e-03 -7.39740282e-02 -2.10999046e-02 -4.64837477e-02
 -1.46982248e-03 -2.61100680e-02 -3.57524888e-03 -8.64636078e-02
  3.01553868e-02 -8.00747648e-02  2.36185780e-03  3.17307673e-02
 -1.60033405e-02 -3.52651477e-02 -2.05644928e-02  4.45551500e-02
 -1.41517278e-02  8.38100836e-02 -6.06795289e-02  7.52996951e-02
 -8.23060423e-02 -6.16672486e-02 -4.07793075e-02  1.15885222e-02
  4.17452604e-02  2.33437531e-02 -3.99350598e-02  1.82938874e-02
 -2.14208532e-02 -2.57780328e-02  6.02568984e-02  8.45688805e-02
  6.11780882e-02 -5.14352918e-02 -3.33843343e-02 -7.12030055e-03
 -3.35678412e-03  4.61051278e-02  5.22496551e-02  6.97190017e-02
  1.12279458e-03  1.22080617e-01 -5.23925684e-02 -5.09487763e-02
  5.77556062e-03  5.89533150e-02 -1.39556930e-03  1.59074869e-02
 -5.89968637e-02 -5.13679758e-02 -5.31414784e-02 -5.47071733e-02
  1.33411456e-02 -1.10388976e-02  8.04858506e-02 -5.83143011e-02
 -6.52193725e-02  2.40470506e-02  6.02436159e-03 -1.93912424e-02
 -3.26655135e-02  1.13309227e-01 -4.33994271e-03  1.27229989e-02
 -3.03914156e-02  4.96463813e-02  3.30351405e-02  1.44130623e-33
  3.89412418e-02  8.65667909e-02  1.54372212e-03 -4.20337319e-02
 -2.75346842e-02 -7.60803418e-03  4.08086069e-02 -4.94568283e-03
 -7.51792360e-03 -3.63144241e-02 -4.76810448e-02  9.59105045e-02
  6.64612651e-02 -4.47743386e-02 -1.15888990e-01 -1.92776993e-02
  1.99373290e-02  3.57339419e-02 -7.65382424e-02  1.66248810e-02
  4.44175303e-02 -7.77422488e-02  7.04237595e-02  2.79642409e-03
  9.47428346e-02 -8.32776278e-02  6.40658988e-03 -9.73582442e-04
  6.10738099e-02 -1.35323433e-02  5.68410903e-02  3.18084732e-02
  2.41724458e-02  1.52559690e-02  1.22384923e-02  6.64872900e-02
  4.97278087e-02  4.82028089e-02 -6.90724701e-02 -1.62126985e-03
 -8.99958611e-03  6.22861162e-02  1.87581331e-02 -2.90628755e-03
 -1.08186588e-01 -6.65786192e-02  5.23467250e-02  4.13378002e-03
  7.79702887e-02 -1.63746849e-02  3.08896452e-02  6.95303231e-02
 -6.74015284e-02 -3.30706760e-02 -8.81353859e-03 -4.05163653e-02
 -1.68614965e-02  4.33460958e-02 -4.25902233e-02 -5.84428422e-02
  7.98114762e-02  1.17122673e-03  2.93481629e-03 -5.09277508e-02
 -1.34080440e-01 -1.01605684e-01  1.44756790e-02 -5.48357479e-02
 -3.57382856e-02  4.35620137e-02  7.47384802e-02  5.23562729e-02
  1.10722274e-01  1.51707958e-02 -1.49706183e-02 -1.04306899e-02
 -3.70826162e-02 -2.19887332e-03 -3.35846394e-02  4.08490859e-02
  3.24572262e-04 -5.79269938e-02 -4.90752310e-02  5.69758080e-02
 -2.02532951e-02  4.80161794e-02 -8.61208513e-03 -2.95076636e-03
 -3.30944993e-02 -3.95459635e-03 -6.88669309e-02 -4.44276184e-02
  6.28337190e-02  4.86137755e-02  4.66567911e-02 -2.29605087e-33
 -5.02783759e-03 -2.77566463e-02 -1.60589609e-02 -1.14323117e-01
  5.40301800e-02 -2.46013775e-02  4.59924340e-02  6.58738166e-02
  1.89823601e-02 -2.14205645e-02  2.03707404e-02 -3.52064930e-02
  6.52305083e-03  8.70303437e-02  7.17718229e-02  4.46883999e-02
  1.66304018e-02 -1.41298017e-02  2.97429301e-02 -4.57291231e-02
  7.51071190e-03  1.06330037e-01 -2.69625690e-02  4.31486741e-02
 -6.42893463e-02  2.55965721e-02  7.15383962e-02 -7.73172826e-02
 -4.19211853e-03 -1.98274683e-02  7.82412812e-02 -9.01875421e-02
 -1.08176269e-01  5.76240905e-02 -1.14127183e-02 -5.43708391e-02
 -5.84570803e-02  1.56813860e-02 -2.14386247e-02  2.23246985e-03
  4.94684167e-02  1.19666569e-01 -4.71327715e-02  5.97783588e-02
 -1.23766102e-02  4.94523868e-02 -2.28338651e-02 -1.55048398e-02
  5.12673892e-03 -2.85744723e-02  4.13732454e-02 -4.99606282e-02
  1.45658199e-02  5.59654348e-02  6.04802072e-02  1.51970908e-02
  5.13871796e-02 -1.37562692e-01  2.69270018e-02  3.50857899e-02
 -6.94386140e-02 -2.92075537e-02  3.21447826e-03  5.17263040e-02
 -1.36309667e-02 -1.72646344e-02 -1.26489541e-02  7.25711137e-03
 -2.59828870e-03 -6.16553798e-02  5.73519617e-02 -9.20593068e-02
 -4.38621230e-02 -1.45432316e-02  4.31116670e-02  1.01980992e-01
 -1.21443711e-01  2.22543385e-02 -2.33766604e-02  3.00243571e-02
  5.39638326e-02  4.42528613e-02  1.61770899e-02  3.76523808e-02
 -4.04622741e-02 -9.18368027e-02  1.15662664e-02 -7.57340854e-03
  5.85798919e-02  1.37049966e-02 -6.45044399e-03 -6.38723969e-02
 -3.55406441e-02 -6.97441921e-02  2.41442234e-03 -2.05446131e-08
  6.34225132e-03  1.00210477e-02  2.06740777e-04  9.23843533e-02
  4.41626459e-02 -3.32968682e-02  5.28358147e-02  6.17117845e-02
 -5.81824891e-02 -3.83095071e-02 -4.87669036e-02 -1.01940939e-03
  2.46082470e-02 -3.91242877e-02  8.98790210e-02 -5.72210364e-03
 -4.17985208e-02 -7.46313622e-03  2.15838663e-02  6.65993392e-02
  2.19103619e-02  5.47685772e-02 -1.09880203e-02 -2.70271134e-02
 -1.98619105e-02  4.70586717e-02  3.89627367e-02  2.38130651e-02
 -3.28032412e-02 -3.91130373e-02 -9.88145024e-02  1.93043500e-02
  4.48098406e-02 -5.62278368e-02 -1.73554923e-02  5.39128110e-03
  2.30300669e-02 -1.12332935e-02 -1.18853174e-01 -3.46396789e-02
  3.25869285e-02 -1.93795357e-02  5.27996831e-02  2.28699371e-02
  4.70609590e-02 -4.06771600e-02  1.86776444e-02 -6.94532394e-02
  1.20022232e-02 -6.47603571e-02 -4.59435768e-02 -8.79549682e-02
  1.32392421e-01  8.63398891e-03 -5.39725907e-02 -4.16229405e-02
  2.22412311e-02  5.56979552e-02 -2.63415445e-02 -6.09129779e-02
  2.64739674e-02 -5.62030775e-03 -5.39683513e-02  7.53898099e-02]"
Get the top 5 least and most profitable products overall time,"WITH
main AS (
  SELECT  
    name AS product_name
    , products.id AS products_id
    , ROUND(retail_price) AS retail_price
    , ROUND(cost) AS cost
    , SUM(sale_price-cost) AS profit
  FROM `bigquery-public-data.thelook_ecommerce.products` products
  JOIN `bigquery-public-data.thelook_ecommerce.order_items` orders 
    ON products.id = orders.product_id
  WHERE 
    status = 'Complete'
  GROUP BY 1,2,3,4
)
, top_least AS (
  SELECT  *
   , RANK() OVER (ORDER BY profit ASC) AS top_rank
    FROM main
)
, top_most AS (
    SELECT  *
   , RANK() OVER (ORDER BY profit DESC) AS top_rank
    FROM main
)
SELECT * , 'least profit' AS rank_values
FROM top_least 
UNION ALL
SELECT * , 'most profit' AS rank_values
FROM top_most
ORDER BY top_rank, rank_values DESC
LIMIT 10","`bigquery-public-data.thelook_ecommerce.products`
`bigquery-public-data.thelook_ecommerce.order_items`","products, order_items","[ 2.09272839e-02 -5.12465499e-02  1.57658421e-02 -5.81564829e-02
  4.58427928e-02  4.69913855e-02  3.11401784e-02  1.23927958e-01
 -3.29517014e-02 -4.97984253e-02 -4.50684987e-02  1.86134018e-02
 -1.74211916e-02  2.10707448e-02 -2.07336452e-02 -2.77054566e-03
  6.10366203e-02 -4.10940917e-03  2.70444751e-02 -1.39883131e-01
  1.42460112e-02 -4.88226674e-02  7.21977726e-02 -4.26512025e-02
  6.12962618e-02  2.39209514e-02 -5.58406115e-02  1.98940448e-02
 -2.16165446e-02 -8.14616010e-02 -6.59783781e-02 -2.85959430e-02
  8.75294060e-02  1.33558400e-02 -4.11502235e-02 -5.84716052e-02
 -3.62233655e-03 -4.08694372e-02  4.10985164e-02 -2.35079136e-03
  3.39815486e-03 -5.05090691e-02 -7.50539824e-02 -4.27141674e-02
 -1.07271615e-02 -1.49156181e-02  4.61833663e-02  2.78576426e-02
 -2.39941827e-03  9.87972692e-02 -8.70313272e-02  1.13396002e-02
 -5.12663275e-02 -3.83427404e-02 -2.80135088e-02 -3.66722718e-02
 -6.32074028e-02 -4.56285216e-02  2.85542407e-03 -4.66583390e-03
  2.66438965e-02 -6.96644261e-02 -4.08105291e-02 -1.24556189e-02
  3.83877233e-02 -2.21249904e-03 -8.51352606e-03  7.31768310e-02
 -1.32574588e-01  3.11992448e-02 -2.54752859e-02 -5.74898571e-02
 -5.56312762e-02  3.07741668e-02 -1.48323579e-02  7.11280620e-03
  8.41076002e-02 -3.92383859e-02  1.08637207e-03  6.92403987e-02
 -4.39618118e-02  3.27648148e-02 -1.05627693e-01  4.37843241e-02
  5.22748567e-03 -3.32521722e-02  3.57877202e-02  4.32625413e-02
  7.48229176e-02 -3.44850458e-02 -5.02147228e-02  4.10891175e-02
  6.14766730e-03 -2.28712428e-02 -2.50604264e-02  1.79781877e-02
 -7.15120742e-03 -6.34854212e-02  2.57154070e-02  1.29713546e-02
  9.83700622e-03 -2.78085452e-02  1.38099510e-02 -7.64861628e-02
 -2.70870868e-02 -4.32333536e-02  2.73175426e-02  7.46936649e-02
 -1.43245806e-03  2.69238967e-02 -5.14405966e-02  6.33631134e-03
 -4.22408655e-02 -5.48743345e-02  1.50862960e-02  1.86761320e-02
 -1.57350616e-03  5.89218270e-03  9.58047807e-02  2.87687331e-02
  3.10430694e-02  8.28924999e-02  1.15374319e-01 -1.83277410e-02
 -6.93253279e-02  6.39334843e-02  4.49707806e-02  8.47318001e-34
 -4.94546555e-02 -1.36491265e-02  5.21195456e-02 -5.35863079e-02
 -3.07415295e-02  5.20755053e-02  3.05184419e-03 -2.53699999e-02
  4.38957401e-02  3.98314558e-02 -5.77601977e-02  3.25413719e-02
 -4.23715487e-02 -2.49666683e-02  1.00655511e-01  2.34068371e-02
  1.53885419e-02  3.72109264e-02 -1.50406826e-02 -7.70522058e-02
 -2.86775660e-02 -2.85891965e-02  7.97174653e-05 -2.93710437e-02
  1.79907233e-02 -2.51655616e-02 -4.42373678e-02 -5.70273586e-02
  3.74278799e-02 -2.39382200e-02  4.49825004e-02  3.84955443e-02
 -3.13394307e-03 -4.54383269e-02 -3.49665433e-02  5.27381152e-02
  8.37490615e-03  2.35338733e-02  7.38049150e-02  4.16985080e-02
 -5.48035093e-02 -9.30124242e-03 -2.95298900e-02 -8.97359848e-03
 -8.22462421e-03  5.48680648e-02 -4.71353754e-02  2.01776111e-03
 -5.06036766e-02  4.79902625e-02 -1.16319761e-01 -1.36645809e-02
  8.32196847e-02 -4.84290421e-02  2.41316971e-04  1.21824546e-02
  1.65977888e-02 -3.38440724e-02  1.35894902e-02  7.30510280e-02
 -4.67050560e-02  3.90531570e-02  8.26871116e-03 -6.06393069e-02
 -9.65993032e-02  1.49355428e-02  7.75413439e-02 -5.80129493e-03
  2.30726432e-02  1.06155835e-01  2.79118996e-02  8.30633752e-03
  7.86360577e-02 -8.25016350e-02  6.42191991e-02  9.23030078e-02
  1.01313025e-01 -3.82843241e-02  2.47827955e-02 -7.93911458e-05
  5.88689819e-02  5.15316892e-03  5.89380525e-02 -1.65213144e-03
  4.69786301e-02  3.98786813e-02  4.66853417e-02 -1.89690813e-02
  1.90403275e-02  1.87999010e-02 -9.55807194e-02  2.10295115e-02
  3.97837944e-02  4.36381511e-02 -8.80880356e-02  1.21145598e-35
  9.57647897e-03 -2.94369105e-02  1.33757561e-01  5.66508174e-02
  6.13238439e-02 -5.48066711e-03 -1.15302727e-02 -4.70338911e-02
 -2.64214855e-02  9.78879631e-02  3.44528370e-02 -4.73679462e-03
  3.41074616e-02 -3.33420075e-02 -4.94434359e-03  7.02203363e-02
  7.69453347e-02 -1.12078197e-01  2.75617260e-02 -1.12793453e-01
  5.10308929e-02  9.46515128e-02 -8.14479962e-02  3.96238640e-02
  1.42402789e-02  3.40894312e-02 -5.34923077e-02  1.11948950e-02
  1.84516404e-02 -5.48867807e-02 -1.08783999e-02 -6.13011457e-02
  2.41836887e-02  1.32406512e-02 -8.28497112e-03  2.56256312e-02
  1.26227513e-02  1.34770977e-04  3.11050043e-02  3.63488086e-02
  6.59640953e-02 -4.51919958e-02 -9.96864773e-03 -5.68434745e-02
 -4.22015674e-02  6.43103383e-03 -8.27569142e-02 -9.54568852e-03
  1.83800850e-02  4.40384112e-02 -2.16693375e-02  2.23215073e-02
 -1.06981233e-01 -3.33461445e-03 -5.61537556e-02  6.26915097e-02
  1.50676873e-02  1.17570776e-02  1.60892047e-02  1.38452160e-03
 -4.82290704e-03  3.75181809e-02  2.48542130e-02  4.73264270e-02
  1.24527374e-02 -5.47395181e-03  1.27481997e-01 -1.49865244e-02
 -7.79643729e-02 -1.04918867e-01 -1.51939383e-02  7.70566240e-02
  7.31796697e-02 -8.76598284e-02 -1.10326394e-01  1.13337703e-01
  1.55314384e-02  6.99019879e-02  1.42519446e-02 -4.39975783e-02
  2.80878730e-02 -3.09136305e-02 -2.87885014e-02 -4.06857431e-02
 -7.47891814e-02  5.04269116e-02  5.11648059e-02 -7.74345547e-02
  4.79200110e-02  2.32323874e-02 -8.65225196e-02 -5.46246544e-02
 -1.39118079e-02  8.54656324e-02  2.79680360e-02 -1.93975112e-08
  6.00275174e-02 -7.05918968e-02  2.47404166e-02  2.02770531e-02
  1.91258341e-02 -7.07766460e-03  2.25331653e-02  1.03433497e-01
  8.98421779e-02  2.43513733e-02  7.87857175e-02 -5.21449931e-02
 -5.74571937e-02  9.87301245e-02  1.70466525e-03 -2.51791608e-02
 -4.96096425e-02  2.76565123e-02  1.70237068e-02 -1.10999621e-01
 -2.72284006e-03  8.06049705e-02  1.09463938e-01 -5.80439940e-02
 -5.83274588e-02 -7.40675954e-03  6.07056953e-02  2.44043954e-02
  5.24802692e-02  2.32760776e-02  2.37677656e-02  3.16419685e-03
  1.75029729e-02 -3.86270136e-02 -2.11769287e-02 -4.72595692e-02
 -7.16655403e-02 -7.33739790e-03 -1.28837094e-01  5.24333604e-02
 -2.04637274e-02 -3.08100116e-02 -5.66977672e-02  1.98864751e-02
  1.95792112e-02 -6.44344538e-02 -5.84428720e-02 -2.24872623e-02
  5.04939295e-02 -1.59335863e-02  2.00225897e-02 -3.15717869e-02
  6.74178749e-02 -7.35287219e-02  2.34521367e-02  3.56337130e-02
  1.45478873e-02 -4.62884828e-02 -4.53243665e-02 -2.59956587e-02
  1.51673295e-02 -7.50529468e-02  9.22073871e-02  6.31423518e-02]"
"Create a query to get Month to Date total profit in each product category of the past 3 months (current date 15 Aug 2022), breakdown by month and categories","WITH
total_profit AS (
  SELECT 
    DATE(orders.shipped_at) AS order_date
    , products.category AS product_categories
    , SUM(sale_price-cost) AS profit
  FROM `bigquery-public-data.thelook_ecommerce.products` products
  INNER JOIN `bigquery-public-data.thelook_ecommerce.order_items` orders 
  ON products.id = orders.product_id
  WHERE status = 'Complete'
    AND orders.created_at BETWEEN '2022-06-01'AND '2022-08-15'
  GROUP BY 1,2
  ORDER BY 2,1
),
MTD_table AS (
  SELECT
    order_date
    , product_categories
    , profit
    , SUM(profit) OVER(PARTITION BY product_categories, EXTRACT(MONTH FROM order_date) ORDER BY 2,1) AS MTD
  FROM total_profit
  ORDER BY 2,1
)
SELECT 
  order_date
  , product_categories
  , ROUND(MTD, 3) AS MTD
FROM MTD_table
WHERE order_date BETWEEN '2022-06-01'AND '2022-08-15'
  AND EXTRACT(DAY FROM order_date) = 15","`bigquery-public-data.thelook_ecommerce.products`
`bigquery-public-data.thelook_ecommerce.order_items`","products, order_items","[ 4.17142995e-02 -1.16551630e-02 -7.55068511e-02 -2.09009144e-02
 -6.56617284e-02  2.94569898e-02 -4.98533137e-02 -1.31792771e-02
 -2.62890887e-02  2.46576797e-02  6.55231550e-02 -6.99299499e-02
 -3.51028070e-02 -3.93466577e-02  6.90488368e-02  6.93180040e-02
  2.02263594e-02  9.65215787e-02  6.52974099e-02 -5.23828715e-02
  1.55862458e-02 -2.68053841e-02  1.00449873e-02 -1.52556142e-02
  3.60578187e-02  5.34146652e-03  5.23378374e-03  2.33382662e-03
  1.20045478e-02  7.85293337e-03 -8.90625343e-02  2.76257023e-02
 -1.58363599e-02  1.91565398e-02 -1.94429569e-02 -6.16281070e-02
 -1.15022637e-01 -4.34507616e-02 -1.30440956e-02  1.98833942e-02
 -8.44957754e-02  1.52611658e-02  9.53028351e-03 -7.29811564e-02
 -1.71292759e-02 -1.75551139e-02 -5.37438244e-02  6.21444248e-02
  5.23586273e-02  4.96066967e-03 -6.36659116e-02 -1.84161041e-03
 -2.94418409e-02  2.13643201e-02 -3.63642760e-02 -5.41711748e-02
 -6.70860186e-02 -5.86237665e-03 -3.20387073e-02  2.68110130e-02
 -1.57655459e-02  1.10689029e-02  4.83563961e-03 -3.52029018e-02
  8.29874445e-03 -9.36882868e-02 -2.20585838e-02  9.40487534e-02
 -7.59758800e-02  4.57884707e-02 -1.95409209e-02 -5.69060706e-02
 -6.22635409e-02 -7.88593069e-02 -4.82511334e-02  5.05720116e-02
  9.17280242e-02 -2.36870181e-02  1.39943715e-02  6.93420786e-03
 -6.12200908e-02  6.90700188e-02 -9.55237523e-02  4.19869795e-02
  3.03072818e-02 -1.23821571e-02  6.57121371e-03 -1.67500321e-02
 -8.02366436e-03  3.14980745e-02  1.82120048e-03  6.11070544e-02
 -1.49022443e-02  1.14317108e-02 -4.67795022e-02 -8.71406645e-02
  4.40704782e-04 -8.39157477e-02  1.33308604e-01  2.99447477e-02
  3.11669279e-02  4.83075827e-02 -7.70058185e-02 -1.02773882e-01
 -6.39379546e-02  2.79793963e-02  4.68789786e-03  7.71327838e-02
  7.91662838e-03  6.43581599e-02 -5.99179305e-02 -2.76791658e-02
 -1.45248082e-02 -8.33952650e-02  1.68820135e-02  4.35683839e-02
 -1.42601626e-02 -6.37001991e-02  1.37496680e-01  3.55668701e-02
  3.16676497e-02  1.46364748e-01 -1.77639332e-02  9.74007044e-03
 -4.28899452e-02 -3.39786969e-02  3.80117781e-02  4.55592395e-35
  1.17370198e-02 -1.12737179e-01 -4.33098758e-03 -1.00642946e-02
  5.51203173e-03  9.44551080e-02  1.07123658e-01 -3.87969054e-02
  2.96258982e-02  4.10176516e-02 -3.52883860e-02  1.64191369e-02
 -6.21438250e-02 -8.18494633e-02  5.37292920e-02  2.38244468e-03
  2.56590322e-02 -6.90703839e-03  1.09331291e-02  3.41222435e-02
  6.06471226e-02 -6.80441931e-02  8.43264833e-02  3.48433107e-02
  3.45776603e-02 -1.65554807e-02 -3.00338250e-02  4.31631366e-03
  3.93502694e-03  2.82887071e-02  1.47608653e-01  1.36586698e-02
 -6.34688213e-02 -8.23688284e-02 -1.88536011e-02  2.36322060e-02
 -1.32437730e-02  6.46560872e-03  8.42393711e-02  7.03265443e-02
 -1.73365325e-02 -4.78971265e-02  4.13110703e-02 -4.83397916e-02
 -1.95200145e-02  7.08645806e-02 -2.17540860e-02 -1.23273740e-02
  1.72870550e-02  5.51775806e-02 -2.27706656e-02 -9.75255966e-02
  2.92213298e-02 -8.52710530e-02  5.87303611e-03  4.74401005e-02
 -7.08553791e-02  1.07967257e-02 -6.54012058e-03 -5.30582201e-03
 -9.42791626e-02  4.79302891e-02  1.11744642e-01 -4.29991707e-02
 -1.19838603e-01  3.08498442e-02  2.03112680e-02  2.68295389e-02
 -5.49090765e-02  8.97010341e-02 -2.57078037e-02  3.24068181e-02
  4.25900556e-02 -4.24508639e-02  3.20202224e-02 -6.62615476e-03
  2.51637567e-02 -2.63401750e-03  7.12883752e-03  5.56341037e-02
  6.07483499e-02  2.02828809e-03  1.09882422e-01 -2.19321493e-02
 -1.85806770e-02  1.24102971e-02  1.56619214e-02  3.37010017e-03
  5.36719225e-02 -2.46553187e-04 -9.26408246e-02  5.37485220e-02
  1.94776040e-02  8.20494443e-02 -4.32766834e-03 -2.03628370e-33
 -4.75900806e-03  6.46760538e-02  7.02081621e-02 -6.52681813e-02
  3.70306224e-02 -2.62638591e-02 -6.87864050e-02  3.86071056e-02
 -5.75895160e-02  1.10530078e-01 -4.50119786e-02  2.56422013e-02
 -8.08745809e-03  1.95254963e-02  1.62507221e-02  3.71424519e-02
  1.13321869e-02  1.24627464e-02 -1.97074134e-02  5.07698767e-03
 -2.81321425e-02  1.63470313e-01 -8.45589414e-02  1.61091406e-02
 -1.84978526e-02  1.31199211e-02  3.64033948e-03 -9.85192694e-03
 -1.95619948e-02 -4.06228825e-02  1.91284884e-02 -1.01541713e-01
  4.15836042e-03 -4.93950360e-02  1.06558772e-02 -1.65367555e-02
  4.92306761e-02 -7.43509680e-02  1.92900039e-02 -9.61373150e-02
  7.68616274e-02 -1.24009782e-02  2.33390145e-02  2.01542452e-02
  3.14667262e-02 -2.23809201e-02  7.78069124e-02 -3.50501277e-02
  1.01251572e-01  1.88215878e-02 -3.14607583e-02 -5.46106175e-02
  3.23635223e-03  4.30742104e-04 -1.69770978e-02  6.66940957e-02
  1.92805231e-02 -4.60480452e-02 -2.22906992e-02 -3.37470658e-02
 -3.94433029e-02  1.52566424e-02  9.05441195e-02 -3.11305672e-02
  5.03634708e-03  2.09738821e-04  2.47621555e-02 -1.07501321e-01
  4.46598455e-02  6.87381625e-03 -1.17654894e-02  1.33359358e-01
 -1.70638226e-02 -2.49056444e-02 -6.95314333e-02  7.35771060e-02
 -7.10071102e-02 -2.65362728e-02 -2.44327486e-02 -2.14726049e-02
  5.58959041e-03  6.92578452e-03  2.72719543e-02  4.93615791e-02
 -6.17573522e-02 -1.87605750e-02 -3.57993133e-02  2.85678892e-03
 -1.59085412e-02 -4.81823599e-03 -4.25202884e-02 -4.86024916e-02
 -9.16130096e-03  3.49947400e-02  5.00236563e-02 -2.25565415e-08
  8.68464261e-02  3.79811935e-02 -6.97525814e-02  1.02121346e-01
  2.28468738e-02 -1.00230269e-01  3.28825265e-02  4.61113378e-02
 -1.97256580e-02 -5.53969014e-03  1.86283607e-02 -1.64879523e-02
 -5.88565543e-02  3.53975184e-02  1.80538464e-03  3.60049456e-02
 -2.51458287e-02 -1.81337073e-03  2.61323638e-02 -6.90691695e-02
  8.07165727e-02  3.58880907e-02  1.11560740e-01  4.35660817e-02
 -5.48818335e-02  2.14207526e-02 -3.24861668e-02  5.35089150e-02
  6.89396635e-02 -1.02731427e-02 -1.30991274e-02 -2.88379230e-02
  2.62082880e-03 -3.19092907e-03 -1.87616069e-02 -5.36670089e-02
 -6.06656000e-02 -5.08696549e-02 -7.81128928e-02 -3.12628523e-02
  3.13422009e-02  2.81551648e-02  6.38436675e-02  2.56207753e-02
 -6.27995357e-02 -6.02317862e-02  1.41598994e-03 -5.53986020e-02
  1.22312391e-02 -3.98921780e-02 -2.50006430e-02 -3.08056511e-02
  2.09174380e-02 -3.71415652e-02  5.83519563e-02  3.46271619e-02
 -1.89285874e-02 -5.03268167e-02 -8.17103982e-02 -2.07362585e-02
 -1.99614791e-03 -1.43358007e-01  2.00399533e-02  5.71841709e-02]"
"Find monthly growth of inventory in percentage breakdown by product categories, ordered by time descending. After analyzing the monthly growth, is there any interesting insight that we can get?","WITH inventory AS
(  SELECT 
    FORMAT_DATE('%Y-%m', created_at) AS Month_Year
    , product_category AS categories
    , COUNT(id) AS total_inventory
  FROM `bigquery-public-data.thelook_ecommerce.inventory_items`
  WHERE created_at BETWEEN '2019-01-01' AND '2022-04-30'
  GROUP BY 1,2 ) ,
previous_inventory as 
( SELECT *
  , LAG (total_inventory) over (partition by inventory.categories order by PARSE_DATE('%Y-%m', Month_year)DESC,inventory.categories) AS total_prev_inv
  FROM inventory )

SELECT *, ROUND((total_inventory-total_prev_inv)/total_prev_inv*100) AS Growth
FROM previous_inventory
ORDER BY 1,2",- bigquery-public-data.thelook_ecommerce.inventory_items,inventory_items,"[ 2.76539978e-02 -3.70760970e-02 -2.18843091e-02 -5.36556961e-03
 -3.13088596e-02  9.63507406e-03 -7.71956146e-02  7.58567220e-03
  1.28139397e-02  1.41714187e-02  6.87884539e-02  5.70414215e-02
 -2.04592142e-02  1.05778649e-02  2.08562743e-02  7.58259967e-02
  6.48320373e-03  3.49045321e-02 -9.30459145e-03 -9.27367806e-02
 -4.64616083e-02 -7.98914954e-02  1.55312074e-02 -1.28329135e-02
  3.03548237e-04 -1.78196765e-02 -4.30090725e-02  9.31779109e-03
  3.15539353e-02 -2.17030551e-02 -7.56626725e-02  1.36584923e-01
  1.16797090e-01  5.43054156e-02 -5.67702241e-02 -5.49681894e-02
  1.23954443e-02 -2.48563550e-02  5.23781255e-02  1.62169486e-02
 -3.50373574e-02  5.34468144e-02 -1.70140639e-02 -4.71432693e-02
  3.52889933e-02 -1.89463585e-03 -6.62523210e-02  9.10950601e-02
 -2.94155590e-02  5.13892286e-02 -7.98401013e-02  5.46782725e-02
 -1.12315835e-02  4.14233729e-02 -5.20249736e-03 -5.34699950e-03
 -9.88065265e-03 -8.52665529e-02  6.97612995e-03  3.38112935e-02
 -9.01246630e-03  3.38656418e-02 -4.33084220e-02 -5.06887473e-02
  4.87944819e-02 -1.07005322e-02  7.09997769e-03  8.79218653e-02
 -7.08584711e-02  1.15873842e-02  1.38479229e-02  2.21270486e-03
 -4.75039072e-02 -2.91218255e-02 -2.89083682e-02  1.78534631e-02
  3.36411446e-02 -2.12366190e-02  1.37670450e-02 -1.42157711e-02
 -1.64072700e-02  9.60827619e-02 -7.56756961e-02 -2.75671594e-02
 -3.61619605e-04 -4.34096046e-02  4.43301350e-02 -2.57647615e-02
 -3.51190269e-02  1.99528169e-02  5.55624776e-02  1.99309960e-02
  3.10449731e-02 -2.62460150e-02 -1.51247205e-02 -2.00902275e-03
 -4.12509926e-02 -7.31851533e-02  9.00493041e-02 -1.98339820e-02
  2.24481914e-02  2.70405170e-02 -2.05042884e-02 -9.69578996e-02
 -9.24467668e-02 -3.08776926e-02 -2.76574865e-02  2.37682443e-02
  4.95543778e-02  8.64909887e-02 -4.77761999e-02  1.71454214e-02
 -3.44561189e-02 -4.39319648e-02  1.00384711e-03  8.86122230e-03
  3.05936262e-02 -2.51671802e-02  4.39015850e-02  2.83953063e-02
  8.59922022e-02  1.26405656e-01  7.44152756e-04  8.36588293e-02
  1.19301854e-02  9.37330723e-02  7.39163160e-02 -1.10236841e-33
 -2.30862573e-03 -1.10648103e-01  2.05717385e-02  8.88460781e-03
  9.19046998e-03 -1.28001766e-02  2.44814754e-02 -3.79065197e-04
  8.31369758e-02  2.41419282e-02 -7.08968118e-02  9.86696482e-02
 -5.85587211e-02 -5.68623748e-03  7.38666430e-02 -6.59438297e-02
  1.70360804e-02  3.24117579e-02 -8.80626589e-03 -3.55162323e-02
 -4.56193127e-02 -2.50392165e-02  2.97387596e-02 -1.17861442e-02
  5.86849079e-02 -2.94732768e-02 -6.58582803e-03  6.46623084e-03
 -5.02968580e-02  2.59666294e-02  1.07156366e-01  4.26834710e-02
 -7.48203918e-02 -1.10457689e-01 -2.04212330e-02 -2.73151062e-02
  1.03858504e-02  8.05689171e-02  7.46848509e-02  1.49942969e-03
  1.30750646e-03 -9.79203638e-03 -4.18021753e-02 -1.07460804e-02
 -1.09518655e-01  1.70501489e-02 -1.13375140e-02 -9.75803379e-03
  4.55171280e-02  3.61469164e-02 -8.22953656e-02 -5.78193069e-02
  3.75999995e-02 -6.02949224e-02 -1.36530818e-02  3.69392633e-02
 -3.16394642e-02 -7.59641677e-02  2.79465020e-02  2.33652797e-02
 -5.63212372e-02  5.26920930e-02  1.00182980e-01  2.79238634e-02
 -9.51545164e-02 -1.91561971e-02  5.57560101e-02  4.72610667e-02
 -3.43678705e-02  1.49626330e-01  6.65177219e-03  1.95708312e-02
  3.68881859e-02 -6.29624128e-02  4.58045937e-02 -7.70952739e-03
  4.11741249e-02  2.22214721e-02 -6.24332912e-02 -4.09666495e-03
  2.16453336e-02 -2.60340609e-02  1.22071981e-01 -5.07454723e-02
 -1.68047398e-02 -1.72523060e-03  5.00667728e-02  3.49824391e-02
  3.43434289e-02 -1.82687510e-02 -1.69857293e-02  9.05858260e-03
  3.13629657e-02  5.88385798e-02  2.67731901e-02 -1.24904228e-33
 -3.59891877e-02  1.59302726e-02  8.98465961e-02 -4.31772508e-02
 -1.54148124e-03 -7.57172406e-02 -7.36822337e-02  5.66827022e-02
 -5.40458262e-02  8.70557353e-02 -1.29080694e-02  6.25195280e-02
 -5.54783717e-02  5.34141473e-02  8.50056205e-03  4.09597307e-02
  1.56666469e-02  2.42028721e-02  3.48998681e-02 -2.10644249e-02
 -7.44265467e-02  2.23550927e-02 -6.54780641e-02 -2.50772443e-02
 -2.53040381e-02  5.52905118e-03 -1.41260801e-02  4.77029346e-02
  2.51331343e-03 -7.61948600e-02 -7.08721904e-03 -7.46272877e-02
  4.62415032e-02 -4.71249595e-02 -3.86848897e-02 -1.66933946e-02
 -4.33711112e-02 -3.41606289e-02  2.41241828e-02 -5.06975166e-02
  8.93127322e-02 -9.17582132e-04 -3.62701192e-02 -4.77631316e-02
  3.50730196e-02 -5.89109808e-02  8.99221003e-02 -3.92900966e-03
  1.10220328e-01  4.59046289e-03  3.83238085e-02  3.52406204e-02
  3.47568840e-02  1.88891646e-02  4.25590435e-03  1.59363374e-01
 -2.91981944e-03 -1.69947166e-02 -5.05850315e-02 -2.56045312e-02
 -4.95852455e-02  3.61842886e-02  2.52163541e-02 -1.12481624e-01
  6.95278589e-03  7.59500917e-03  2.13116538e-02 -9.10217762e-02
  9.02347080e-03 -2.85126753e-02  6.78645894e-02  1.05708592e-01
  4.72634211e-02 -1.70146059e-02 -1.13357842e-01  2.24859025e-02
 -3.55452336e-02 -1.27989314e-02 -3.55496295e-02 -2.56260000e-02
 -2.40737926e-02 -3.65941599e-02 -9.32578556e-03  4.15926054e-02
 -1.49358585e-01 -4.06335518e-02  1.47070391e-02 -3.99841145e-02
 -5.05546331e-02  2.05207299e-02 -2.29185093e-02 -6.70790821e-02
 -7.87419081e-02 -1.68681629e-02  5.72581999e-02 -2.56304098e-08
 -7.51207210e-03 -6.39712662e-02  2.18711351e-03  4.07023765e-02
  8.25477093e-02  7.10183661e-03  7.67381787e-02  8.82427692e-02
 -2.71591060e-02  8.69494956e-03  1.62963441e-03  2.99112108e-02
 -1.03088662e-01  4.84267585e-02 -6.27268851e-02  8.55830964e-03
 -4.55369875e-02 -1.09917540e-02 -2.24538706e-02 -1.14567615e-01
  6.01539314e-02  8.89828429e-02  1.79945722e-01  4.61722873e-02
 -8.47545788e-02 -2.59536207e-02 -1.13547808e-02  6.73562884e-02
  4.38092463e-02 -1.65028293e-02  3.63418609e-02 -1.00983242e-02
 -1.25075588e-02 -3.85278799e-02  1.78574696e-02 -6.40668953e-03
 -1.03940763e-01 -6.88042417e-02 -7.72211701e-02 -8.09864849e-02
 -1.97917484e-02 -5.06728142e-02  3.74964997e-03  6.87004859e-03
 -3.85710970e-03 -6.59023002e-02 -5.69616482e-02  3.31507064e-02
  3.71492319e-02 -1.43588269e-02  1.56430900e-02 -3.19560505e-02
 -2.10724939e-02  2.33590845e-02  5.69590069e-02  1.60536170e-02
 -2.23805290e-02 -5.73463440e-02 -3.30457091e-02 -2.73173209e-02
  2.27816403e-02 -6.49704710e-02  1.16464691e-02  3.80072482e-02]"
"Create monthly retention cohorts (the groups, or cohorts, can be defined based upon the date that a user completely purchased a product) and then how many of them (%) coming back for the following months in 2022. After analyzing the retention cohort, is there any interesting insight that we can get?","WITH 
cohort_items AS (
    SELECT 
    user_id,
    MIN(DATE_TRUNC(DATE(created_at),MONTH)) AS cohort_month
  FROM `bigquery-public-data.thelook_ecommerce.orders`
  GROUP BY 1
),
users_activities AS 
(SELECT 
    orders.user_id user_id,  DATE_DIFF(DATE_TRUNC(DATE(orders.created_at),MONTH),cohort.cohort_month,MONTH) AS month_number
  FROM `bigquery-public-data.thelook_ecommerce.orders` orders
  LEFT JOIN cohort_items AS cohort ON orders.user_id = cohort.user_id
  WHERE EXTRACT(year FROM cohort.cohort_month) = 2022
  GROUP BY 1,2
),
cohort_size AS (
  SELECT cohort_month,
  COUNT(DISTINCT user_id) AS num_users
  FROM cohort_items
  GROUP BY 1
  ORDER BY 1
),
retention AS (
  SELECT cohort.cohort_month AS cohort_month,
  us_act.month_number AS month_number,
  COUNT(DISTINCT us_act.user_id) AS num_users
  FROM users_activities AS us_act LEFT JOIN cohort_items AS cohort ON us_act.user_id = cohort.user_id
  GROUP BY 1,2
)
SELECT 
  FORMAT_DATE('%Y-%m', retention.cohort_month) Month_year,
  retention.month_number,
  retention.num_users total_users,
  ROUND(CAST(retention.num_users as decimal)/cs.num_users*100,2) retention_percentage
FROM retention LEFT JOIN cohort_size AS cs ON retention.cohort_month = cs.cohort_month
WHERE retention.cohort_month is not null
ORDER BY PARSE_DATE('%Y-%m',Month_year),2,3",bigquery-public-data.thelook_ecommerce.orders,orders,"[-9.75278579e-03 -4.75436635e-02 -4.20783982e-02  1.00577651e-02
  1.22047542e-02  8.82868171e-02 -9.69790109e-03  2.14292128e-02
 -1.86825301e-02 -7.27993250e-02  7.28736743e-02  7.50002861e-02
  1.17824003e-02  1.52296387e-03  1.90459918e-02  5.28239063e-04
 -2.64775455e-02 -5.86106442e-02  1.69371888e-02 -4.65302505e-02
 -5.87641224e-02 -7.54047781e-02 -1.22134732e-02  5.25895096e-02
 -1.49865728e-02  8.71152710e-03  3.83100994e-02 -4.52114344e-02
  1.19654201e-02  6.60746694e-02  1.10081770e-02  1.17946140e-01
  3.52820568e-02 -8.22688639e-03 -3.85085605e-02  7.89402612e-03
 -7.71320686e-02 -3.57510075e-02 -3.05618551e-02  6.05723215e-03
 -6.55000061e-02 -5.11313751e-02 -2.00602356e-02  6.27475828e-02
  1.97999533e-02 -2.71131266e-02 -4.95609976e-02  1.08452007e-01
 -9.96620208e-02  1.34490490e-01  3.35464925e-02 -1.53003745e-02
  6.84169214e-03  5.14677502e-02 -1.40598221e-02 -8.27055983e-03
 -3.81869674e-02 -4.39303704e-02 -9.57876667e-02  1.39962658e-02
  1.11142611e-02 -1.23187907e-01 -4.40963767e-02 -2.15964913e-02
 -6.24395758e-02  7.41842622e-03  3.59114483e-02  7.38545507e-02
  1.60317346e-02  2.60769185e-02 -1.10851675e-02  7.88414734e-04
 -4.99683246e-02  5.47900386e-02 -2.97710318e-02  8.45613778e-02
  9.03410986e-02  2.97383945e-02  6.89124390e-02 -6.73795938e-02
 -3.22501338e-03  3.78182437e-03 -4.09995578e-02  2.00017802e-02
  2.21473668e-02 -5.66200279e-02  1.67645290e-02 -5.43634705e-02
 -7.07200840e-02  1.58697665e-02  6.54374808e-02  6.51213229e-02
  8.03702101e-02 -8.87829810e-03 -1.04480922e-01  1.01439832e-02
 -9.35824588e-03  1.68074726e-03  8.78842771e-02 -1.43699339e-02
 -2.00297758e-02  7.77351111e-02 -2.92499028e-02 -5.34499483e-03
 -9.58015993e-02 -6.78027347e-02 -4.21267115e-02  3.43841165e-02
  5.22921048e-02  9.23665464e-02 -1.01863347e-01  6.44413475e-03
  6.45637885e-02  5.56701683e-02  8.04529265e-02 -9.73376632e-03
  7.86608027e-04  5.22335852e-03  8.63861069e-02  1.13791838e-01
  5.43331020e-02  1.15952268e-01  2.86975633e-02  1.91092771e-02
  2.11224565e-03  6.89219013e-02  3.37371565e-02  5.53096127e-34
 -2.09034886e-02 -6.83659501e-03 -3.01886816e-02  1.06138326e-01
 -7.83372894e-02 -6.22730441e-02 -2.47484026e-03  6.14598505e-02
 -9.81225632e-03 -6.07464500e-02 -5.03016300e-02  6.45558164e-02
 -1.35823172e-02  7.02780560e-02  2.93719508e-02 -1.47497356e-02
 -3.17140929e-02  8.81547481e-02  8.13413262e-02 -3.17303166e-02
 -4.93166149e-02  6.50539994e-04  2.88060345e-02 -6.64312858e-03
  3.98647860e-02 -4.24168110e-02  2.41731293e-02  1.87378470e-02
 -2.33123899e-02  4.34766039e-02  8.19495916e-02  5.15590496e-02
 -1.91539731e-02 -1.20866053e-01 -1.37291965e-03  5.66056706e-02
  1.81039143e-02 -4.82063275e-03  8.56611431e-02 -1.99594218e-02
 -7.31429597e-03  5.18409070e-03  6.91038519e-02  1.34006906e-02
 -7.44798183e-02 -6.86868057e-02  5.82587868e-02 -8.49693548e-03
 -5.18429726e-02  3.27264071e-02 -9.11630988e-02 -4.77277860e-02
 -4.24705073e-02  8.09913129e-03 -1.30752595e-02 -7.24078668e-03
 -1.08828366e-01 -7.06687719e-02  3.18569085e-03 -2.86600254e-02
  5.15946709e-02  6.96915388e-02  3.83796394e-02 -5.28291194e-03
 -1.03700660e-01  5.59766917e-03 -5.67018893e-03 -1.78481340e-02
 -7.11864680e-02  1.11635968e-01  2.97485534e-02 -1.56119317e-02
 -5.04051335e-02 -6.63601533e-02 -1.46297123e-02 -1.67279001e-02
  1.01649418e-01  3.44979391e-02  7.67433411e-03  1.37035199e-03
  4.45468351e-02 -5.38372993e-02  4.01154198e-02  1.14276214e-03
  7.00908597e-04 -1.35336479e-03  1.18390001e-01 -6.08795881e-02
 -1.87758077e-02 -6.17108010e-02 -9.00269207e-03 -3.99439186e-02
  4.35362048e-02  1.01679452e-01  6.80038880e-04 -2.48451200e-33
 -3.76972444e-02  6.47031739e-02  4.49067764e-02 -2.07420047e-02
  4.21177298e-02 -4.15418744e-02 -5.86391762e-02  5.91573790e-02
 -2.88413521e-02 -2.24128570e-02  4.47377749e-03  5.59163094e-02
  2.19996925e-02  1.10335901e-01 -8.10380429e-02 -9.96771269e-03
 -1.02298502e-02 -1.04143173e-01 -9.93022695e-03 -1.87158585e-02
 -4.72237682e-03 -1.00747883e-01 -7.02895001e-02 -1.42111313e-02
 -4.32909019e-02  6.06013201e-02 -5.09508513e-02 -4.04987000e-02
 -1.08807627e-02 -2.12383121e-02 -1.52582191e-02 -1.41313732e-01
 -1.69663485e-02 -8.04647058e-02  2.35252380e-02 -6.66689649e-02
  1.78233702e-02 -7.32446322e-04  1.45268263e-02 -3.58414464e-02
  7.49878511e-02 -1.07536456e-02 -7.01025361e-03 -6.32328689e-02
  2.77535301e-02 -1.65789984e-02  1.23485699e-01  9.98144317e-03
  7.54661411e-02  2.13129912e-02 -3.01348455e-02  1.47617087e-02
 -3.98832820e-02  2.12231092e-02 -2.40490492e-02 -1.61547549e-02
  3.26708220e-02 -5.12378179e-02 -2.41000913e-02 -1.26838707e-03
 -3.96845713e-02  2.89128777e-02 -1.28249675e-02 -1.62241906e-02
 -7.59598706e-03 -9.35293585e-02  4.12932783e-02 -2.54183039e-02
 -1.11762121e-01  1.44226095e-02  3.54942456e-02  4.58298288e-02
 -5.53503968e-02 -4.76506129e-02 -5.42085320e-02 -6.19459851e-03
 -5.97143285e-02 -3.52415033e-02 -7.40809739e-02 -5.94886136e-04
 -5.95558733e-02 -3.94952968e-02 -4.87698019e-02  3.48498523e-02
 -7.23008066e-02 -2.64454298e-02 -4.13267426e-02 -9.20805708e-03
 -3.87720168e-02  1.41621465e-02 -3.93571407e-02 -5.70488162e-02
 -1.14178792e-01 -1.54694617e-02  1.19415270e-02 -3.73624403e-08
  3.41910124e-02  4.23873737e-02  1.16676979e-01  5.05585000e-02
  6.71412349e-02 -2.79059727e-02 -3.15978900e-02  6.18747696e-02
  2.13081911e-02 -1.32938689e-02  5.47133153e-03  3.13218236e-02
 -5.49437106e-02 -9.11104400e-03 -7.06102923e-02  7.13949874e-02
  1.08489988e-03  4.52232920e-03  1.59013004e-03 -2.92334724e-02
 -1.06706121e-03  2.14428250e-02  1.56170785e-01  2.26113535e-02
 -6.41405433e-02  8.92101508e-03  3.28815021e-02  1.05378233e-01
  3.66029851e-02 -5.34454696e-02  8.27961788e-03  3.28086875e-02
  9.40907449e-02 -4.94793877e-02 -1.12535488e-02 -1.96640957e-02
 -6.04431145e-02 -6.72582304e-03 -1.32912500e-02  2.41903756e-02
 -4.23520319e-02 -2.68682037e-02 -4.68788290e-04  5.68450168e-02
  6.77171946e-02 -2.62371413e-02  2.08469182e-02  2.18232404e-02
 -2.95082461e-02  1.28988018e-02  3.25314747e-03 -4.27309349e-02
  4.70139831e-03  7.59728551e-02  4.80120927e-02 -1.66270672e-03
 -1.17300591e-02 -3.69835794e-02 -2.34258939e-02 -3.45640182e-02
  2.87739886e-03 -1.73092857e-02 -3.41477208e-02 -1.61642451e-02]"
What are the 5 most ordered product categories?,"SELECT p.category, COUNT(oi.order_id) AS order_count
FROM bigquery-public-data.thelook_ecommerce.order_items oi
INNER JOIN `bigquery-public-data.thelook_ecommerce.products` AS p
ON oi.product_id = p.id
GROUP BY p.category
ORDER BY order_count DESC
LIMIT 5;","bigquery-public-data.thelook_ecommerce.order_items
bigquery-public-data.thelook_ecommerce.products","order_items, products","[ 4.63271849e-02 -9.04472843e-02  2.19735932e-02 -7.00684544e-03
 -7.39349425e-03  5.90593889e-02 -3.40739600e-02  4.17831400e-03
  2.57751020e-03  6.04528636e-02  1.00064427e-02  3.18224914e-02
 -5.09493984e-02 -2.81936186e-03  3.97145189e-03  3.65066826e-02
  2.43671685e-02  1.21689104e-02 -4.97495309e-02 -9.73608270e-02
  1.77252535e-02  3.86114307e-02  4.53972444e-02  3.79685778e-03
 -1.32816257e-02 -6.37234934e-03 -5.08965477e-02 -4.14787456e-02
 -3.52905132e-02 -1.42726570e-01 -9.52452645e-02  1.67141594e-02
  3.76103446e-02  5.36415018e-02 -5.44433892e-02 -7.51684755e-02
 -2.06205668e-03 -9.49193165e-02  2.30629351e-02  5.68599328e-02
 -2.52454840e-02 -1.96854584e-02 -1.78945977e-02 -1.37316482e-02
  3.77530307e-02 -1.21736503e-03 -3.14780734e-02  1.06447171e-02
  3.18653695e-03  2.76661795e-02 -8.90105218e-02  3.35707981e-03
 -1.26592919e-01  9.39817950e-02 -2.86649093e-02 -4.27273288e-02
 -5.40390573e-02 -5.01770414e-02  8.68265703e-03  3.54300402e-02
 -2.43049338e-02 -2.39920858e-02 -3.51538211e-02  3.70310619e-02
 -3.73391695e-02  1.05127599e-02 -5.43735921e-02 -2.24598907e-02
 -4.22438607e-02  8.50912556e-02 -2.57877279e-02 -4.53869179e-02
 -1.14171924e-02  4.47513908e-02  1.33969961e-02 -2.78079454e-02
  1.12669013e-01 -1.03392743e-01 -5.44157885e-02 -3.19238715e-02
 -1.23043992e-01  5.22034466e-02 -4.18360084e-02  2.69336794e-02
  8.08849093e-03 -1.57419443e-02 -9.30705294e-03  6.57872409e-02
 -9.47102383e-02  2.88592950e-02 -3.55113707e-02 -2.56795739e-03
  4.01858762e-02  1.28821926e-02 -7.42823407e-02 -3.50166881e-03
  3.67363356e-02 -6.50502145e-02 -2.29393318e-02  1.02948518e-02
  2.17695311e-02 -2.76388358e-02  3.14265899e-02 -2.38172598e-02
 -3.91621925e-02 -6.45487010e-02 -4.62877471e-03  1.72867998e-02
  6.08962849e-02  3.65197696e-02 -1.25152111e-01 -1.58249680e-02
 -1.05698332e-01 -9.55603942e-02 -6.93277344e-02 -3.67060602e-02
  6.98791072e-03  3.01076490e-02  1.16368942e-01 -2.06250660e-02
 -1.27818584e-02  6.72998801e-02  9.97372195e-02 -1.56651530e-02
 -7.66503066e-02  7.42124543e-02  3.36557743e-03 -3.15671918e-33
 -5.49448794e-03 -1.15384825e-01  6.68626353e-02  1.38556920e-02
  4.35417611e-03  3.00720744e-02  1.34981601e-02 -2.43134480e-02
  2.47492585e-02  6.02437630e-02 -2.00410802e-02  6.79164454e-02
 -3.74751873e-02  7.50442743e-02  1.13403559e-01 -1.39497481e-02
 -3.02632023e-02  5.42111434e-02 -9.89043415e-02 -3.14327665e-02
 -5.46646677e-02  9.55706388e-02  7.87739921e-03  1.23361675e-02
 -2.00469587e-02 -1.09283365e-02 -1.77820567e-02  1.10580996e-02
  3.14991511e-02  1.54695017e-02 -7.92517141e-03  9.68567468e-03
  3.65648158e-02 -8.23651254e-02 -1.64730405e-03  2.36686803e-02
 -2.30849218e-02  1.58785004e-03  8.65592137e-02  1.06082680e-02
  1.18769007e-02 -6.33998737e-02 -6.10276163e-02  6.53735101e-02
  5.49623631e-02  5.46860173e-02 -5.26886545e-02  4.91136871e-02
  4.13357615e-02  2.51229499e-02 -6.61508366e-02  2.84060906e-03
  7.35630766e-02 -1.22330163e-03 -1.58289466e-02 -6.80597574e-02
 -1.40633937e-02 -7.51164630e-02 -1.43994046e-02  8.69580880e-02
 -7.50530213e-02  9.80405509e-02  6.75032884e-02 -1.43538034e-02
 -1.00443745e-03 -3.09559051e-03  6.91537410e-02 -3.68632115e-02
  5.16064791e-03  8.45372155e-02  9.53779649e-03  8.41575041e-02
  5.58779053e-02 -2.73366738e-02  9.04288236e-03  5.31707369e-02
  1.95653848e-02 -2.64665857e-02 -6.11574501e-02 -4.05870229e-02
 -3.51885036e-02  7.75282644e-03  6.73020557e-02  7.42384419e-02
 -5.11535816e-02  2.92243268e-02  2.63654743e-03 -3.28197628e-02
  6.13163263e-02  3.90619002e-02 -9.54375863e-02 -1.86700001e-02
  8.86019394e-02  1.95850078e-02 -4.39279713e-02  1.61530262e-33
 -2.69162208e-02 -8.24650377e-02  4.00745124e-02  6.85388669e-02
  6.11052886e-02 -3.03480756e-02 -5.24569340e-02 -3.26853245e-02
 -5.16587272e-02  9.15757045e-02  2.56928671e-02  4.70317192e-02
  4.86719385e-02 -3.05656996e-03  5.25262803e-02  7.03049600e-02
  1.99175421e-02 -1.10028675e-02  4.16563749e-02 -1.78097393e-02
  2.72647198e-02  9.66914892e-02 -7.07854331e-02  7.67137110e-02
  8.32357723e-03  4.84668799e-02  5.04755974e-02 -2.86348127e-02
  2.69954465e-02 -1.10480487e-01  3.27385892e-03 -6.71029761e-02
  2.44608931e-02  3.87151130e-02  2.38615125e-02  1.57060008e-02
 -1.49596790e-02  1.56547048e-03 -3.40004489e-02  9.17229503e-02
  3.50700505e-02 -2.40898412e-03 -1.42625412e-02  6.59471527e-02
 -2.09573954e-02 -9.68802124e-02 -4.67271283e-02 -2.33716983e-02
  9.73952585e-04  6.08234480e-02 -3.93794067e-02  3.09060887e-02
 -3.08993347e-02 -2.36772001e-02  1.69190820e-02  6.40409589e-02
 -5.35103269e-02  3.25610191e-02  6.29291311e-02  3.16117816e-02
  2.32546087e-02  6.70218542e-02  7.34590366e-02 -4.23540883e-02
  2.77931970e-02 -2.79933922e-02  6.13544993e-02 -6.89462817e-04
 -9.25739408e-02 -8.42746422e-02  9.61389113e-03  6.18025400e-02
  1.03854598e-03 -4.82600965e-02 -9.38170105e-02 -1.13667361e-02
  1.29353264e-02  3.03460062e-02  2.04438269e-02  4.91697434e-03
  1.46786058e-02 -2.31717322e-02  4.14966494e-02  6.01882637e-02
 -1.97972003e-02 -2.38927063e-02  5.79566844e-02  2.06288733e-02
  8.20088834e-02  6.54012710e-02 -4.85682358e-05 -2.10336857e-02
  3.57274674e-02  8.06952119e-02  2.88453065e-02 -1.58220121e-08
  5.72934151e-02 -6.43942086e-03  5.28930314e-03  1.04768192e-02
  1.86471902e-02  2.64825318e-02 -5.10108098e-03  9.28137749e-02
 -8.96821171e-03  7.46855512e-02  4.22174633e-02  4.67135124e-02
 -8.17557946e-02  6.31247610e-02  3.35548148e-02 -5.95217235e-02
 -6.88026939e-03 -2.86738463e-02  5.11471406e-02 -7.44091272e-02
 -5.56325773e-04  3.37730944e-02  1.11674584e-01 -3.53403538e-02
 -7.06759319e-02 -3.96928750e-02  8.35976005e-02  4.59357947e-02
  8.24970677e-02  5.09818122e-02  8.77193641e-03 -1.22703267e-02
 -3.80502455e-02 -5.01671173e-02  2.42232787e-03  9.01187491e-03
 -8.62162039e-02 -4.23005559e-02 -8.85887966e-02 -5.49414046e-02
 -2.91033611e-02 -8.24067891e-02  1.69388074e-02  3.05945165e-02
  1.42489234e-03 -4.95769829e-02 -7.44664818e-02 -2.86533814e-02
 -7.60412868e-03  6.81849662e-03 -1.43055722e-01  1.75244585e-02
 -2.95251980e-02 -3.44688445e-02  1.24815796e-02  4.85419948e-03
  8.71189870e-03 -8.69503990e-02 -6.92787231e-04 -2.81540882e-02
  1.06000088e-01 -2.44685747e-02  7.83499628e-02  6.71760961e-02]"
What are Categories with lowest business growth,"WITH main AS(
  SELECT COUNT(oi.id) AS products_sold,
        ii.product_category AS category,
        DATE(DATE_TRUNC(o.created_at, MONTH)) AS year_month,
        SUM(oi.sale_price) AS revenue,
        SUM(oi.sale_price) - SUM(ii.cost) AS profit
  FROM `bigquery-public-data.thelook_ecommerce.orders` AS o
  JOIN `bigquery-public-data.thelook_ecommerce.order_items` AS oi
  ON oi.order_id = o.order_id
  JOIN `bigquery-public-data.thelook_ecommerce.inventory_items` AS ii
  ON oi.inventory_item_id = ii.id
  WHERE EXTRACT(YEAR FROM o.created_at) IN (2021, 2022)
    AND o.status = 'Complete'
  GROUP BY category, year_month
  ORDER BY category, year_month
),

cte_revenue AS(
  SELECT *
  FROM(
    SELECT * EXCEPT(profit),
          LAG(revenue) OVER(PARTITION BY category ORDER BY year_month) AS previous_revenue
    FROM main
  )
),

cte_profit AS(
  SELECT *
  FROM(
    SELECT * EXCEPT(revenue),
          LAG(profit) OVER(PARTITION BY category ORDER BY year_month) AS previous_profit
    FROM main
  )
)

SELECT main.category,
       main.year_month,
       main.products_sold,
       rev.revenue,
       rev.previous_revenue,
       pro.profit,
       pro.previous_profit,
       (rev.revenue - rev.previous_revenue) / rev.previous_revenue AS revenue_growth,
       (pro.profit - pro.previous_profit)  /pro.previous_profit AS profit_growth
FROM main
JOIN cte_revenue AS rev
ON main.category = rev.category AND main.year_month = rev.year_month
JOIN cte_profit AS pro
ON main.category = pro.category AND main.year_month = pro.year_month
WHERE EXTRACT(YEAR FROM main.year_month) IN (2022)
ORDER BY category, year_month","- bigquery-public-data.thelook_ecommerce.orders
- bigquery-public-data.thelook_ecommerce.order_items
- bigquery-public-data.thelook_ecommerce.inventory_items","orders, order_items, inventory_items","[ 1.20972648e-01 -7.03663602e-02 -4.74585779e-02  1.82988755e-02
 -5.93497418e-02  2.03737598e-02 -8.37384015e-02  5.43552339e-02
  1.66824311e-02  3.40045663e-03  6.42748922e-02  1.47471409e-02
 -8.46380368e-03  1.00518242e-02  1.77973434e-02  2.06210930e-02
 -1.05758198e-02  2.67692748e-02 -3.59955728e-02 -5.52759394e-02
 -3.88318524e-02 -3.54317687e-02  1.65957317e-04 -1.21647827e-02
  4.25480232e-02 -3.23031545e-02 -6.67690206e-03 -2.48670597e-02
 -8.63987207e-03 -7.19686598e-02 -5.16271181e-02  6.80493042e-02
  1.08194485e-01  4.53177467e-02  4.39899676e-02  6.35029515e-03
  4.24952768e-02  1.26689067e-02  7.01673776e-02  4.93150167e-02
 -6.12959564e-02  1.39828185e-02 -9.76166055e-02 -5.52905686e-02
  2.22875364e-03  1.33037148e-03 -3.00644189e-02  7.48987150e-05
 -1.13250680e-01 -5.46951927e-02 -1.50452759e-02  2.26426516e-02
 -2.99717747e-02  5.98474592e-02 -8.47943127e-03 -3.62810344e-02
 -9.89512876e-02 -5.36617227e-02  1.45306196e-02 -1.80403069e-02
  3.97216482e-03 -1.62827328e-03  1.91897657e-02 -3.46467011e-02
  3.39567959e-02  4.60323542e-02 -4.33004461e-02  2.66706366e-02
 -9.11462307e-02  1.43293319e-02  1.83682553e-02 -4.13603485e-02
 -9.93576199e-02  8.74573365e-02 -2.68539111e-03 -8.62544030e-02
  8.36278871e-02  4.42095138e-02 -6.02191500e-03  2.75419001e-03
 -1.58881284e-02  5.67420423e-02 -1.35736376e-01  5.53835407e-02
 -1.25648603e-01 -5.85922925e-03 -8.56465288e-03 -1.98778715e-02
 -3.78629006e-02  1.36200767e-02  3.70164728e-03  5.19069731e-02
  4.64647971e-02  2.96134576e-02 -2.58386564e-02 -1.26104308e-02
  8.69911455e-04 -9.29811522e-02  4.49550059e-03  1.89496707e-02
  2.43820138e-02 -2.48293276e-03  7.08424821e-02  2.91864108e-02
 -1.95107870e-02 -1.92275830e-02  3.07578743e-02  2.54437625e-02
  8.99183843e-03  4.15303744e-02 -3.44901532e-02  1.44081265e-02
 -7.03027919e-02 -8.56633112e-02 -8.03948566e-02 -3.20063643e-02
 -4.55792586e-04  1.29442737e-02  6.57746047e-02  6.02422990e-02
  4.94153015e-02  1.07696444e-01 -2.53382348e-03 -2.55913902e-02
 -3.67963202e-02  8.79812166e-02 -8.14321861e-02 -2.88395582e-33
  4.65396792e-02 -1.01746410e-01  2.21977271e-02 -2.90721771e-03
  1.63322706e-02  2.53369547e-02 -3.65045145e-02 -3.71947214e-02
  1.98474042e-02  9.67483371e-02 -5.94388880e-02  1.42977074e-01
 -4.16432507e-02 -1.05050718e-02  1.52208388e-01 -2.46634744e-02
 -5.70450863e-03  8.37960094e-02 -2.63183024e-02 -4.16233130e-02
 -4.00149971e-02  6.96477294e-02  1.56688020e-02 -1.85000636e-02
  5.18607423e-02  1.37962140e-02  1.95205193e-02 -1.92421842e-02
  9.42562055e-03 -3.78798088e-03  5.42383380e-02 -2.69959401e-02
  1.34669617e-02 -9.29424837e-02 -2.81721856e-02 -6.69403002e-03
 -3.32447775e-02  3.46476659e-02  5.40377051e-02 -4.93322946e-02
 -1.06691778e-01 -6.82718307e-03 -2.48780753e-02  1.78903379e-02
  2.13784967e-02  5.06558269e-02  9.28178579e-02 -4.28488618e-03
 -1.88117474e-02  5.81450053e-02  1.65294949e-02 -2.30349321e-02
  1.02221677e-02 -1.37814200e-02 -2.21548229e-03 -8.03734362e-03
  6.54092617e-03 -1.06959097e-01 -7.26638436e-02  2.14739889e-02
 -1.94854178e-02  1.69066321e-02 -3.88287641e-02  3.85929346e-02
 -9.19951405e-03 -4.69081849e-03  3.02741658e-02  1.35651352e-02
  2.32948847e-02  3.85085344e-02  6.91914931e-02  1.82807464e-02
  4.15670201e-02 -3.44153792e-02  7.27321357e-02  5.22635914e-02
  1.09031089e-02 -4.92411060e-03 -1.36303017e-02  4.90350416e-03
  3.82255181e-03 -1.37138311e-02  3.75496075e-02 -1.68478955e-02
 -2.88029611e-02  1.65870544e-02  7.38362074e-02  5.43591082e-02
  3.52196917e-02  2.91656423e-02 -1.65731311e-01  1.10439854e-02
 -2.63791848e-02  1.03393972e-01  4.68252376e-02  1.88371696e-34
 -3.11782528e-02 -4.70792316e-02  3.04132663e-02 -1.30715109e-02
 -6.41997997e-03  3.72494012e-02  5.05761541e-02 -4.48562205e-02
 -1.92300919e-02  4.68166396e-02 -1.92695670e-02  2.99205221e-02
 -9.45926178e-03  2.72271484e-02  3.29230577e-02 -4.29204777e-02
  2.28066444e-02  5.57377003e-04  7.03065172e-02  1.22983297e-02
  2.38868967e-02  1.13938220e-01 -1.48941040e-01  9.48237851e-02
  2.27167197e-02  1.51010416e-02 -1.45224839e-01 -7.39930617e-03
 -2.59573516e-02 -6.79119602e-02 -1.50014069e-02  7.59918848e-03
  8.61947909e-02 -8.73756781e-03 -2.87328809e-02 -2.37137992e-02
 -8.85110721e-02 -1.04145803e-01 -1.80934388e-02  9.22031794e-03
  4.71810438e-03  2.81699486e-02 -9.64309275e-03  5.52501995e-03
 -1.73470005e-02 -3.76916416e-02 -2.02173926e-02 -1.63501427e-02
  8.95056799e-02 -4.70335595e-02 -3.05475015e-02 -6.34693261e-03
  9.14430537e-04  4.93684784e-02  3.02589443e-02  1.18468270e-01
 -2.75639407e-02 -1.24517521e-02 -4.21719737e-02  6.21769354e-02
  3.28954719e-02  1.48425100e-03  6.12386651e-02  2.00580750e-02
 -2.08492652e-02 -3.07119992e-02  4.95773256e-02 -2.84108729e-03
  2.53005000e-03 -1.09480880e-01  6.09030500e-02  9.27776694e-02
  1.60672814e-02 -5.50526604e-02 -1.26758531e-01 -5.88908186e-03
  1.82834119e-02 -1.86627836e-03  2.75160596e-02 -2.29618419e-02
  2.83244271e-02 -1.49111282e-02  4.61917231e-03  3.57404090e-02
 -4.68852967e-02 -3.41132209e-02  3.30548324e-02 -9.55792740e-02
  6.59371261e-03  7.44050294e-02 -1.23007730e-01 -5.94813339e-02
 -4.20133863e-03  2.16664486e-02 -3.27945165e-02 -1.55409250e-08
 -1.93523392e-02  1.04809068e-02 -1.34923914e-02  3.20644602e-02
  3.77434269e-02 -3.91962305e-02  1.09317619e-02  9.18855891e-02
  2.20485795e-02  1.08988762e-01 -6.27604499e-02  3.27407010e-02
 -8.18735808e-02  7.43965283e-02  3.68513204e-02  6.97001535e-03
 -2.63019726e-02  1.32385083e-03  4.23611887e-02 -3.35116722e-02
  7.72052109e-02  8.23217854e-02  6.55299276e-02 -5.23481481e-02
 -3.37582417e-02 -1.11030474e-01  6.86916113e-02  4.58452478e-02
 -3.08254324e-02 -1.70883927e-02  6.29817471e-02  2.58387681e-02
  1.22956315e-03 -3.06123383e-02  9.53723211e-03  4.75751199e-02
 -8.91624838e-02  4.66669910e-02 -1.08324155e-01 -1.73619129e-02
 -2.13078093e-02 -6.43014163e-02 -2.81987526e-03 -2.38828827e-02
 -5.00362739e-02 -9.07092467e-02 -6.83702156e-02  2.10136399e-02
  5.88136129e-02 -4.04754989e-02 -9.02444683e-03  1.89443212e-02
 -2.26372872e-02 -4.82318588e-02 -6.42405543e-03 -6.65492471e-03
 -4.65073902e-03 -1.76267102e-02 -1.03935882e-01 -1.69932488e-02
  7.11869746e-02 -7.61646107e-02  3.31390649e-02  5.97436875e-02]"
What is Monthly Growth of Inventory?,"WITH main AS(
  SELECT product_category AS category,
         DATE(DATE_TRUNC(ii.created_at, MONTH)) AS year_month,
         count(ii.id) AS stock
  FROM `bigquery-public-data.thelook_ecommerce.inventory_items` AS ii
  LEFT JOIN `bigquery-public-data.thelook_ecommerce.order_items` AS oi
  ON ii.id = oi.inventory_item_id
  WHERE EXTRACT(YEAR FROM ii.created_at) IN (2021, 2022)
    AND ii.sold_at IS NULL
  GROUP BY category, year_month
),

cte_inventory AS(
  SELECT *
    FROM(
      SELECT *,
            LAG(stock) OVER(PARTITION BY category ORDER BY year_month) AS previous_stock
      FROM main
    )
)

SELECT *,
        (stock - previous_stock) / previous_stock AS inventory_growth
FROM cte_inventory
WHERE EXTRACT(YEAR FROM year_month) IN (2022)
ORDER BY category, year_month","- bigquery-public-data.thelook_ecommerce.inventory_items
- bigquery-public-data.thelook_ecommerce.order_items","inventory_items, order_items","[ 1.27800945e-02 -3.86849977e-02 -7.20581189e-02  4.18246090e-02
 -2.98997331e-02 -1.14810476e-02 -4.85349447e-02 -1.10085215e-02
  6.97216857e-03  4.07091305e-02  9.27475169e-02  4.20469604e-02
 -1.03857080e-02 -1.93705559e-02 -2.91984174e-02  2.93305144e-03
 -1.22423368e-02 -3.91601324e-02  3.36701833e-02 -2.72115245e-02
 -2.14291085e-02 -6.13174923e-02 -7.69112632e-03 -1.31965764e-02
  1.54387057e-02 -2.92653646e-02 -4.96268161e-02 -2.06116289e-02
  7.63955265e-02 -5.71011147e-03 -5.65326549e-02  1.32838890e-01
  1.34135559e-01  3.31577323e-02 -3.47008631e-02  1.33998739e-02
  1.64725110e-02 -1.96848740e-03  3.63779850e-02  4.24788706e-03
 -2.77642105e-02 -1.54255861e-02 -4.48099896e-02 -5.32685444e-02
  1.94268115e-02 -3.93266156e-02 -7.14111188e-03  1.01188064e-01
 -2.36868374e-02  5.03848307e-02 -1.28355063e-02  1.68798044e-02
 -5.32800257e-02  5.84206060e-02  3.06186546e-02  1.69174536e-03
 -1.15772858e-02 -2.35966723e-02 -5.48509089e-03  2.03873198e-02
 -2.07078587e-02  3.42653017e-04 -8.13418254e-02 -1.33031961e-02
  1.32187679e-01 -3.68919573e-04  1.17275547e-02  8.79321843e-02
 -6.79556206e-02 -2.21039951e-02  3.10314889e-03 -1.63044482e-02
 -2.88930554e-02  9.32351314e-03 -2.11858209e-02 -2.15444993e-02
 -4.13549831e-03 -2.53029503e-02  7.87856281e-02  1.45554007e-03
 -4.55613323e-02  8.29015076e-02 -6.06427304e-02 -5.31357937e-02
 -3.04552587e-03 -2.10813191e-02  4.69829068e-02 -1.06540881e-02
 -7.22004753e-03 -7.29733845e-04  6.83531761e-02  4.01362106e-02
  1.04687884e-02 -2.75346525e-02 -7.93669969e-02  6.48785103e-03
 -4.03359421e-02 -6.02983907e-02  6.27131835e-02  2.84309546e-03
  9.03748646e-02  7.51673728e-02  3.18039507e-02 -1.42776119e-02
 -8.71776938e-02 -2.48519406e-02 -2.97950786e-02 -9.61362291e-03
 -6.50449935e-03  8.91442150e-02 -6.26381412e-02  4.52663563e-02
 -2.29704194e-03 -6.87062368e-02  1.00655505e-03  5.00706546e-02
 -2.13480089e-03 -4.46421269e-04  3.21964659e-02  4.62713987e-02
  9.87124518e-02  9.08712596e-02 -2.25469749e-02  8.34542559e-04
 -5.01288176e-02  5.87481149e-02  5.58238216e-02 -4.39467453e-33
 -1.86540708e-02 -5.50244078e-02  2.49113608e-02  2.97385491e-02
  5.51519357e-03 -1.46556348e-02  3.84286270e-02  3.06869205e-02
  5.68301603e-02  1.93567108e-02 -3.19655873e-02  9.82464477e-02
 -3.89790684e-02  3.70400287e-02  1.24092624e-01 -8.36585835e-02
  1.86255835e-02  7.26928264e-02  1.20462812e-01 -2.23495699e-02
 -4.06941883e-02 -7.42108673e-02  3.59551832e-02 -1.02158757e-02
  7.63545334e-02 -1.47048188e-02  2.85097677e-02  3.55113484e-02
 -5.45832478e-02  2.63533313e-02  1.71324864e-01  4.47500721e-02
 -6.56616539e-02 -8.60794187e-02 -1.74546167e-02 -3.90929915e-02
 -1.91221992e-03  2.81494111e-02  6.39455020e-02 -2.54524257e-02
  3.75058465e-02  2.70092580e-03 -2.38846100e-04  6.85922708e-03
 -8.75240266e-02  3.30692045e-02  5.24842367e-02 -5.67856729e-02
 -1.36105726e-02  8.57105758e-03 -1.48136672e-02 -3.50668542e-02
 -1.81056093e-02 -4.55859490e-02  3.03853005e-02  6.12281933e-02
 -1.78767927e-02 -1.05874799e-01  6.29743328e-03  4.11436800e-03
 -2.87650656e-02  1.99591145e-02  7.54903406e-02  1.44343838e-01
 -4.66720387e-02  2.17457563e-02  4.92906710e-03  4.01846059e-02
 -2.05739718e-02  6.30860403e-02  2.04170868e-02 -1.88855641e-02
  5.58689386e-02 -6.84157461e-02  1.00041379e-03 -4.33830805e-02
  5.30069135e-03 -2.94018798e-02 -6.73871338e-02  3.78944427e-02
 -5.39196432e-02 -2.02226057e-03  6.31825030e-02  4.33961535e-03
 -4.12585139e-02 -1.14331965e-03  1.86948553e-02  7.20486343e-02
  7.81630501e-02 -3.80224586e-02 -3.01183630e-02 -3.86711732e-02
 -2.29799319e-02  3.91350836e-02  1.58740114e-02  2.05523414e-33
  2.66926493e-02  7.17363507e-02  1.87147560e-03 -4.22031735e-05
  1.04434427e-03 -6.31908700e-02 -1.63543820e-02  8.66281688e-02
 -1.71722788e-02  7.14702904e-02 -7.46299252e-02  5.20019792e-02
 -2.61270767e-03  6.38661012e-02  3.20800506e-02  6.02678433e-02
  1.94533672e-02  1.63929742e-02 -1.55477617e-02 -5.95747605e-02
 -9.61305127e-02 -3.03636026e-02 -1.72625892e-02 -2.21711509e-02
 -1.34783098e-02 -1.89331593e-03 -5.30482940e-02  1.55823659e-02
 -4.07708697e-02 -2.53413226e-02  3.35725509e-02 -6.54062256e-02
  2.02703718e-02 -2.02062819e-02 -1.01852836e-02 -2.06401013e-02
  1.77409388e-02 -1.30100222e-02  2.64175031e-02 -1.81199722e-02
  8.42233598e-02 -1.53898159e-02  5.37155829e-02 -3.37764085e-03
  2.98652537e-02 -7.50229657e-02  8.44563320e-02 -3.21046859e-02
  1.26933455e-01 -3.52715477e-02  3.61626968e-03  2.44786050e-02
 -8.52176081e-03 -5.26532577e-03 -1.54307541e-02  1.25311911e-01
 -2.66482141e-02  4.93301898e-02 -5.34192026e-02 -3.30423489e-02
 -5.24396775e-03  2.03033127e-02 -1.23483492e-02 -4.54871878e-02
 -1.10218814e-03  1.15849581e-02  6.05624309e-03 -8.14447626e-02
  2.05314513e-02 -4.19259667e-02  8.38228911e-02  5.52701168e-02
  2.60880366e-02 -6.73489412e-04 -1.59140363e-01  1.38202654e-02
  5.68495318e-03 -3.95082794e-02 -5.72472475e-02 -7.35994335e-03
 -1.10940084e-01 -1.87730975e-02 -1.98460612e-02  7.40916058e-02
 -1.67056367e-01 -7.17946216e-02  3.91299240e-02 -4.36296389e-02
 -6.52105212e-02  4.56918515e-02 -5.55471480e-02 -4.23709378e-02
 -1.17202051e-01 -4.12003249e-02  3.52957360e-02 -1.51900039e-08
 -9.64322500e-03 -6.08764663e-02  5.85438423e-02  5.43516129e-03
  8.63922238e-02 -4.24655154e-02  1.13914229e-01  1.98983867e-02
  3.00042238e-02  2.11380851e-02  4.00487147e-02 -5.01674693e-03
 -7.71372095e-02  1.80803034e-02 -3.04914871e-03  1.13447914e-02
 -6.75786883e-02  9.84737184e-03 -7.34157786e-02 -1.42916992e-01
  5.39781675e-02  8.09762180e-02  1.30360261e-01  1.66333932e-02
 -3.34686786e-02 -6.07202798e-02  1.25997998e-02  6.92459643e-02
  1.92204807e-02 -1.61984097e-02  6.94476441e-02  3.03961802e-02
  4.81740683e-02 -6.34199977e-02 -4.14930377e-03 -5.82202105e-03
 -6.43883869e-02 -2.93456167e-02 -4.10774909e-02 -1.10786848e-01
 -2.50278451e-02 -2.99386512e-02  3.06007564e-02 -8.04842450e-03
  1.33346417e-03 -1.71031132e-02 -1.28393024e-01  3.91309289e-03
  5.22203781e-02 -9.19821262e-02  2.37107594e-02 -1.44391041e-02
  5.40811755e-02  3.91631052e-02  5.93106709e-02  2.44758483e-02
 -4.27001715e-02 -6.93997145e-02 -1.37865664e-02 -2.47979853e-02
 -2.60067414e-02 -8.48523378e-02  8.60816706e-03 -1.64315999e-02]"
What is Monthly User Retention Cohorts?,"WITH first_purchase AS(
  SELECT user_id,
         MIN(DATE(DATE_TRUNC(created_at, MONTH))) AS purchase_month
  FROM `bigquery-public-data.thelook_ecommerce.orders`
  WHERE EXTRACT(YEAR FROM created_at) IN (2022)
    AND status = 'Complete'
  GROUP BY user_id
),

-- only 1 purchase per month tracked here
activity AS(
  SELECT o.user_id,
         DATE_DIFF(
          DATE(DATE_TRUNC(o.created_at, MONTH)),
          fp.purchase_month,
          MONTH
         ) AS month_number
  FROM `bigquery-public-data.thelook_ecommerce.orders` AS o
  JOIN first_purchase AS fp
  ON o.user_id = fp.user_id
  WHERE EXTRACT(YEAR FROM o.created_at) IN (2022)
    AND status = 'Complete'
  GROUP BY o.user_id, month_number
),

cohort_size AS(
  SELECT purchase_month,
         COUNT(user_id) AS num_user
  FROM first_purchase
  GROUP BY purchase_month
  ORDER BY purchase_month
),

retention AS(
  SELECT fp.purchase_month,
         activity.month_number,
         COUNT(activity.user_id) AS num_user
  FROM activity
  JOIN first_purchase AS fp
  ON activity.user_id = fp.user_id
  GROUP BY fp.purchase_month, activity.month_number
  ORDER BY fp.purchase_month, activity.month_number
)

SELECT retention.purchase_month,
       size.num_user AS cohort_size,
       retention.month_number,
       retention.num_user,
       retention.num_user/size.num_user AS retention_percentage
FROM retention
JOIN cohort_size AS size
ON retention.purchase_month = size.purchase_month
ORDER BY purchase_month, month_number",bigquery-public-data.thelook_ecommerce.orders,orders,"[ 2.75362749e-02 -5.76234274e-02 -5.00603914e-02  5.34233600e-02
  1.21466033e-02  5.04294224e-02  3.77998129e-02 -6.47375220e-03
  1.37065807e-02 -5.99464923e-02  5.85768707e-02  3.97956409e-02
 -7.67260324e-03 -3.85157838e-02 -9.55976360e-03 -2.81802714e-02
 -3.26995254e-02 -8.17219242e-02  8.50525200e-02 -4.55636531e-03
 -4.36032712e-02 -4.70205881e-02 -4.06483039e-02  5.84309325e-02
  2.19839215e-02 -1.39418049e-02  2.09515505e-02 -2.89154220e-02
  3.99488118e-03  8.07615593e-02  3.03297304e-02  1.34697378e-01
  5.25099225e-02  8.80863424e-03 -3.70519869e-02  3.43466713e-03
 -7.90874213e-02 -1.33809019e-02 -3.43556255e-02 -1.95642724e-03
 -4.88924980e-02 -4.15756330e-02 -2.77791806e-02  1.93824321e-02
  7.81994313e-03 -9.76175815e-03 -1.08159252e-01  6.65015355e-02
 -7.04844147e-02  1.39063969e-01  7.09047616e-02 -9.98116564e-03
  1.87140871e-02  1.28110200e-01  1.98468361e-02 -5.29749729e-02
 -2.29178686e-02 -1.96352452e-02 -6.66780770e-02  2.53976267e-02
 -3.15710939e-02 -5.50306141e-02 -8.98665413e-02  2.48246081e-02
  8.31685087e-04  7.19712442e-03  5.16968872e-03  3.34260799e-02
  5.68420514e-02 -2.65157633e-02 -9.43209156e-02 -5.15287854e-02
 -8.40717033e-02  4.34863754e-02  1.06706647e-02  3.50305215e-02
  4.04397063e-02 -7.84570724e-03  1.16832994e-01 -5.08365035e-02
 -4.09944430e-02  4.54394855e-02 -3.26927449e-03 -4.86506429e-03
  5.58550283e-02 -4.17392068e-02 -1.11931628e-02 -6.54183775e-02
 -7.56670311e-02 -1.85452644e-02  1.11803308e-01  8.01570266e-02
  4.39898074e-02  6.75149402e-03 -1.14991106e-01 -4.17658351e-02
 -3.16874795e-02 -1.45272072e-03  1.56552382e-02  2.00921912e-02
 -2.64922250e-03  5.43425679e-02 -3.68301268e-03  6.67387247e-02
 -1.14290625e-01 -5.85807860e-02 -6.42538862e-03  4.65583578e-02
  5.36662191e-02  1.15994982e-01 -5.36993109e-02 -3.66022508e-03
  5.60811125e-02  2.51444113e-02  6.84903264e-02  1.98213328e-02
 -2.73550842e-02  2.87837759e-02  1.15780301e-01  1.79303229e-01
  2.70785373e-02  9.27363634e-02 -3.49734239e-02 -3.03036198e-02
 -1.61449499e-02  2.27199495e-02  1.22563168e-02 -2.78899075e-33
  3.18335518e-02 -3.40072857e-03 -2.27697827e-02  6.93037882e-02
 -7.77882785e-02 -4.69375327e-02 -1.66163687e-02  4.78457063e-02
  2.76022404e-02 -6.46205023e-02 -3.96441780e-02  1.14967190e-01
 -1.73139758e-02  6.25756159e-02  5.60677014e-02 -3.14544179e-02
 -2.36551948e-02  1.12787493e-01  6.81974888e-02  3.48660313e-02
  7.16531510e-03 -2.22214311e-02  5.47808483e-02  2.86439597e-03
  4.05567363e-02 -3.49552259e-02  2.13350486e-02  3.10769752e-02
 -6.29945716e-04  5.34231961e-02  8.62610266e-02  6.65180981e-02
 -9.24575422e-03 -1.05622806e-01  1.88136548e-02  5.44340387e-02
  6.29495159e-02 -7.82100949e-03  2.39528045e-02 -4.28663231e-02
 -2.42585205e-02  1.08501725e-02  8.76008496e-02  1.54952444e-02
 -7.74699301e-02 -8.80482271e-02  1.21712238e-01 -3.46014537e-02
 -5.87893650e-02  6.41304329e-02 -2.96802279e-02 -4.61904891e-02
 -6.46349564e-02  3.24519388e-02 -2.12309230e-02  4.69036810e-02
 -5.75420149e-02 -4.72636260e-02 -3.62382445e-04 -3.38226147e-02
  5.07985130e-02  2.75209043e-02  4.22825143e-02  3.07123978e-02
 -5.21212146e-02 -1.53558189e-02 -2.84492057e-02 -2.68886704e-02
 -3.89497839e-02  1.05383374e-01  5.28297271e-04  2.81760958e-03
 -2.23354511e-02 -4.34202179e-02 -6.23781867e-02 -1.93270314e-02
  6.26292452e-02  1.59492306e-02 -4.15020585e-02  5.16789779e-02
  1.11265071e-02 -6.34148866e-02  1.95981376e-02 -1.36665255e-02
  1.69008952e-02 -4.67967754e-03  9.42906812e-02 -4.42144796e-02
 -3.52490023e-02 -4.43843864e-02 -1.02576334e-02 -5.65881431e-02
  1.22805103e-03  7.84951821e-02 -1.90875158e-02  6.62000995e-34
 -6.20068610e-02  4.90810089e-02 -1.15237967e-03 -2.99406983e-02
  3.90909985e-02 -1.43624041e-02 -1.68280525e-03  8.69890302e-02
 -2.87891794e-02 -1.73178650e-02 -7.02894852e-02  1.05415676e-02
  1.90357268e-02  9.70104337e-02 -7.01853726e-03  2.24949582e-03
 -6.21570274e-03 -5.87269664e-02 -5.40053174e-02 -2.75276862e-02
  7.76975462e-03 -6.44434616e-02 -3.97878140e-02 -6.03527166e-02
 -4.64381464e-02  2.96964981e-02 -8.39203671e-02 -2.89308783e-02
 -4.56847325e-02 -1.12544578e-02  1.61630921e-02 -9.63538364e-02
 -6.05675280e-02 -5.88961244e-02  1.67324524e-02 -7.16682747e-02
 -1.77625678e-02  7.96954185e-02 -3.97558920e-02  3.39262225e-02
  6.77096620e-02 -3.25318798e-02  1.21810623e-02 -2.00954638e-02
  7.83674361e-04  2.79583912e-02  4.79283147e-02 -1.55719295e-02
  4.54077125e-02  2.64418474e-03 -4.50695753e-02 -5.14674149e-02
 -2.15725154e-02  4.21764627e-02 -4.30815257e-02 -2.48997230e-02
 -6.30537933e-03 -1.89014934e-02 -3.09439916e-02 -3.78219523e-02
  3.85737717e-02  3.81188616e-02 -7.77745172e-02  2.30279267e-02
 -4.51545883e-03 -7.36815110e-02  4.84963618e-02 -5.55793848e-03
 -8.59430730e-02  3.46110724e-02 -5.79691026e-03  2.17258763e-02
 -6.22526556e-03 -7.94537142e-02 -8.94942060e-02 -3.79394256e-02
 -2.97536850e-02 -4.28391136e-02 -5.96241280e-02 -1.80305410e-02
 -9.13755298e-02 -3.12872492e-02 -7.71407634e-02  4.54295613e-02
 -1.04133114e-01 -6.38273507e-02  1.10050580e-02 -1.74872149e-02
 -3.90734673e-02  5.26312888e-02 -2.12211013e-02 -5.73325865e-02
 -1.40075773e-01 -2.77724862e-02 -2.58702729e-02 -1.58363900e-08
  3.02328039e-02  2.84376051e-02  1.07105918e-01  2.60048676e-02
  6.29006401e-02 -2.98247952e-02  2.47431663e-03  7.52902031e-02
  4.93764840e-02  1.61686130e-02  6.89300671e-02  3.51999998e-02
 -2.64433324e-02 -6.87617958e-02  5.67156868e-03  4.83339019e-02
  1.67340897e-02  1.15943160e-02 -3.83749492e-02 -1.48500018e-02
 -1.48275448e-02  3.09894979e-02  6.57618344e-02 -8.56047124e-03
 -4.71843556e-02  3.46150696e-02  6.03433736e-02  1.34570569e-01
  1.34066921e-02 -5.10925092e-02  1.44955600e-02  5.94407842e-02
  1.12394288e-01 -9.56714377e-02 -3.07088122e-02  4.53697890e-02
 -4.19111326e-02 -3.94461267e-02 -2.24488713e-02  4.61140793e-04
 -1.27828289e-02 -7.62622245e-03  6.40907139e-02  5.03248870e-02
  2.77360193e-02  9.67767835e-03 -3.33672017e-03  4.99075092e-02
  3.80073152e-02 -3.49943675e-02 -1.87803358e-02 -3.30600478e-02
  2.88771857e-02  9.03794467e-02  2.41698176e-02 -1.00822831e-02
  2.16942467e-03 -3.29256095e-02 -3.97053659e-02 -4.72815819e-02
 -1.60061233e-02 -1.55950012e-02 -1.03997905e-02 -3.63400355e-02]"
